---
title: '방법: MetadataLoadContext를 사용하여 어셈블리 콘텐츠 검사'
description: 검사 목적으로 .NET 어셈블리를 로드할 수 있는 API인 MetadataLoadContext를 사용하는 방법을 알아봅니다.
author: MSDN-WhiteKnight
ms.date: 03/10/2020
ms.openlocfilehash: 7205230986aa852813a651d2fcb7c5ef88ab18fe
ms.sourcegitcommit: 965a5af7918acb0a3fd3baf342e15d511ef75188
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 11/18/2020
ms.locfileid: "94831353"
---
# <a name="how-to-inspect-assembly-contents-using-metadataloadcontext"></a><span data-ttu-id="c5067-103">방법: MetadataLoadContext를 사용하여 어셈블리 콘텐츠 검사</span><span class="sxs-lookup"><span data-stu-id="c5067-103">How to: Inspect assembly contents using MetadataLoadContext</span></span>

<span data-ttu-id="c5067-104">개발자는 기본적으로 .NET의 리플렉션 API를 통해 주 실행 컨텍스트에 로드된 어셈블리의 콘텐츠를 검사할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c5067-104">The reflection API in .NET by default enables developers to inspect the contents of assemblies loaded into the main execution context.</span></span> <span data-ttu-id="c5067-105">그러나 예를 들어 다른 플랫폼 또는 프로세서 아키텍처에 대해 컴파일되었거나 [참조 어셈블리](reference-assemblies.md)이기 때문에 어셈블리를 실행 컨텍스트에 로드하지 못할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c5067-105">However, sometimes it isn't possible to load an assembly into the execution context, for example, because it was compiled for another platform or processor architecture, or it's a [reference assembly](reference-assemblies.md).</span></span> <span data-ttu-id="c5067-106"><xref:System.Reflection.MetadataLoadContext?displayProperty=fullName> API를 사용하여 이러한 어셈블리를 로드하고 검사할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c5067-106">The <xref:System.Reflection.MetadataLoadContext?displayProperty=fullName> API allows you to load and inspect such assemblies.</span></span> <span data-ttu-id="c5067-107"><xref:System.Reflection.MetadataLoadContext>에 로드된 어셈블리는 메타데이터로만 처리됩니다. 즉, 어셈블리의 형식을 검사할 수 있지만 여기에 포함된 코드를 실행할 수는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="c5067-107">Assemblies loaded into the <xref:System.Reflection.MetadataLoadContext> are treated only as metadata, that is, you can examine types in the assembly, but you can't execute any code contained in it.</span></span> <span data-ttu-id="c5067-108">주 실행 컨텍스트와 달리 <xref:System.Reflection.MetadataLoadContext>는 현재 디렉터리에서 종속성을 자동으로 로드하지 않고, 전달된 <xref:System.Reflection.MetadataAssemblyResolver>에서 제공하는 사용자 지정 바인딩 논리를 대신 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="c5067-108">Unlike the main execution context, the <xref:System.Reflection.MetadataLoadContext> doesn't automatically load dependencies from the current directory; instead it uses the custom binding logic provided by the <xref:System.Reflection.MetadataAssemblyResolver> passed to it.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="c5067-109">사전 요구 사항</span><span class="sxs-lookup"><span data-stu-id="c5067-109">Prerequisites</span></span>

<span data-ttu-id="c5067-110"><xref:System.Reflection.MetadataLoadContext>를 사용하려면 [MetadataLoadContext](https://www.nuget.org/packages/System.Reflection.MetadataLoadContext) NuGet 패키지를 설치합니다.</span><span class="sxs-lookup"><span data-stu-id="c5067-110">To use <xref:System.Reflection.MetadataLoadContext>, install the [System.Reflection.MetadataLoadContext](https://www.nuget.org/packages/System.Reflection.MetadataLoadContext) NuGet package.</span></span> <span data-ttu-id="c5067-111">모든 .NET Standard 2.0 규격 대상 프레임워크(예: .NET Core 2.0 또는 .NET Framework 4.6.1)에서 지원됩니다.</span><span class="sxs-lookup"><span data-stu-id="c5067-111">It is supported on any .NET Standard 2.0-compliant target framework, for example, .NET Core 2.0 or .NET Framework 4.6.1.</span></span>

## <a name="create-metadataassemblyresolver-for-metadataloadcontext"></a><span data-ttu-id="c5067-112">MetadataLoadContext용 MetadataAssemblyResolver 만들기</span><span class="sxs-lookup"><span data-stu-id="c5067-112">Create MetadataAssemblyResolver for MetadataLoadContext</span></span>

<span data-ttu-id="c5067-113"><xref:System.Reflection.MetadataLoadContext>를 만들려면 <xref:System.Reflection.MetadataAssemblyResolver> 인스턴스를 제공해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c5067-113">Creating the <xref:System.Reflection.MetadataLoadContext> requires providing the instance of the <xref:System.Reflection.MetadataAssemblyResolver>.</span></span> <span data-ttu-id="c5067-114">이를 제공하는 가장 간단한 방법은 지정된 어셈블리 경로 문자열 컬렉션에서 어셈블리를 확인하는 <xref:System.Reflection.PathAssemblyResolver>를 사용하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="c5067-114">The simplest way to provide one is to use the <xref:System.Reflection.PathAssemblyResolver>, which resolves assemblies from the given collection of assembly path strings.</span></span> <span data-ttu-id="c5067-115">이 컬렉션은 직접 검사하려는 어셈블리 외에도 필요한 모든 종속성을 포함해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c5067-115">This collection, besides assemblies you want to inspect directly, should also include all needed dependencies.</span></span> <span data-ttu-id="c5067-116">예를 들어 외부 어셈블리에 있는 사용자 지정 특성을 읽으려면 해당 어셈블리를 포함해야 합니다. 그렇지 않으면 예외가 throw됩니다.</span><span class="sxs-lookup"><span data-stu-id="c5067-116">For example, to read the custom attribute located in an external assembly, you should include that assembly or an exception will be thrown.</span></span> <span data-ttu-id="c5067-117">대부분의 경우 *핵심 어셈블리*, 즉 <xref:System.Object?displayProperty=nameWithType> 같은 기본 제공 시스템 형식을 포함하는 어셈블리를 포함해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c5067-117">In most cases, you should include at least the *core assembly*, that is, the assembly containing built-in system types, such as <xref:System.Object?displayProperty=nameWithType>.</span></span> <span data-ttu-id="c5067-118">다음 코드에서는 검사된 어셈블리 및 현재 런타임의 핵심 어셈블리로 구성된 컬렉션을 사용하여 <xref:System.Reflection.PathAssemblyResolver>를 만드는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="c5067-118">The following code shows how to create the <xref:System.Reflection.PathAssemblyResolver> using the collection consisting of the inspected assembly and the current runtime's core assembly:</span></span>

[!code-csharp[](snippets/inspect-contents-using-metadataloadcontext/MetadataLoadContextSnippets.cs#CoreAssembly)]

<span data-ttu-id="c5067-119">모든 BCL 형식에 액세스해야 하는 경우 컬렉션에 모든 런타임 어셈블리를 포함할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c5067-119">If you need access to all BCL types, you can include all runtime assemblies in the collection.</span></span> <span data-ttu-id="c5067-120">다음 코드에서는 검사된 어셈블리 및 현재 런타임의 모든 어셈블리로 구성된 컬렉션을 사용하여 <xref:System.Reflection.PathAssemblyResolver>를 만드는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="c5067-120">The following code shows how to create the <xref:System.Reflection.PathAssemblyResolver> using the collection consisting of the inspected assembly and all assemblies of the current runtime:</span></span>

[!code-csharp[](snippets/inspect-contents-using-metadataloadcontext/MetadataLoadContextSnippets.cs#RuntimeAssemblies)]

## <a name="create-metadataloadcontext"></a><span data-ttu-id="c5067-121">MetadataLoadContext 만들기</span><span class="sxs-lookup"><span data-stu-id="c5067-121">Create MetadataLoadContext</span></span>

<span data-ttu-id="c5067-122"><xref:System.Reflection.MetadataLoadContext>를 만들려면 이전에 만든 <xref:System.Reflection.MetadataAssemblyResolver>를 첫 번째 매개 변수로 전달하고 핵심 어셈블리 이름을 두 번째 매개 변수로 전달하여 생성자 <xref:System.Reflection.MetadataLoadContext.%23ctor%28System.Reflection.MetadataAssemblyResolver%2CSystem.String%29>를 호출합니다.</span><span class="sxs-lookup"><span data-stu-id="c5067-122">To create the <xref:System.Reflection.MetadataLoadContext>, invoke its constructor <xref:System.Reflection.MetadataLoadContext.%23ctor%28System.Reflection.MetadataAssemblyResolver%2CSystem.String%29>, passing the previously created <xref:System.Reflection.MetadataAssemblyResolver> as the first parameter and the core assembly name as the second parameter.</span></span> <span data-ttu-id="c5067-123">핵심 어셈블리 이름을 생략할 수 있습니다. 이 경우 생성자는 기본 이름인 "mscorlib", "System.webserver" 또는 "netstandard"를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="c5067-123">You can omit the core assembly name, in which case the constructor will attempt to use default names: "mscorlib", "System.Runtime", or "netstandard".</span></span>

<span data-ttu-id="c5067-124">컨텍스트를 만든 후 <xref:System.Reflection.MetadataLoadContext.LoadFromAssemblyPath%2A>와 같은 메서드를 사용하여 어셈블리를 로드할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c5067-124">After you've created the context, you can load assemblies into it using methods such as <xref:System.Reflection.MetadataLoadContext.LoadFromAssemblyPath%2A>.</span></span> <span data-ttu-id="c5067-125">코드 실행과 관련된 어셈블리를 제외하고 로드된 어셈블리에서 모든 리플렉션 API를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c5067-125">You can use all reflection APIs on loaded assemblies except ones that involve code execution.</span></span> <span data-ttu-id="c5067-126"><xref:System.Reflection.MemberInfo.GetCustomAttributes%2A> 메서드는 생성자 실행과 관련되므로 <xref:System.Reflection.MetadataLoadContext>에서 사용자 지정 특성을 검사해야 하는 경우 대신 <xref:System.Reflection.MemberInfo.GetCustomAttributesData%2A> 메서드를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="c5067-126">The <xref:System.Reflection.MemberInfo.GetCustomAttributes%2A> method does involve the execution of constructors, so use the <xref:System.Reflection.MemberInfo.GetCustomAttributesData%2A> method instead when you need to examine custom attributes in the <xref:System.Reflection.MetadataLoadContext>.</span></span>

<span data-ttu-id="c5067-127">다음 코드 샘플에서는 <xref:System.Reflection.MetadataLoadContext>를 만들고, 어셈블리를 로드하고, 어셈블리 특성을 콘솔에 출력합니다.</span><span class="sxs-lookup"><span data-stu-id="c5067-127">The following code sample creates <xref:System.Reflection.MetadataLoadContext>, loads the assembly into it, and outputs assembly attributes into the console:</span></span>

[!code-csharp[](snippets/inspect-contents-using-metadataloadcontext/MetadataLoadContextSnippets.cs#CreateContext)]

## <a name="example"></a><span data-ttu-id="c5067-128">예제</span><span class="sxs-lookup"><span data-stu-id="c5067-128">Example</span></span>

<span data-ttu-id="c5067-129">전체 코드 예제를 보려면 [MetadataLoadContext 샘플을 사용하여 어셈블리 콘텐츠 검사](/samples/dotnet/samples/inspect-assembly-contents-using-metadataloadcontext/)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="c5067-129">For a complete code example, see the [Inspect assembly contents using MetadataLoadContext sample](/samples/dotnet/samples/inspect-assembly-contents-using-metadataloadcontext/).</span></span>
