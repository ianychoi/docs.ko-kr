---
description: '자세한 정보: 대리자 (Visual Basic)'
title: 대리자
ms.date: 07/20/2015
helpviewer_keywords:
- delegates [Visual Basic]
- Visual Basic code, delegates
ms.assetid: 410b60dc-5e60-4ec0-bfae-426755a2ee28
ms.openlocfilehash: aba3c1483f2875600d925ec3edb0167ddfb18125
ms.sourcegitcommit: 10e719780594efc781b15295e499c66f316068b8
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 02/14/2021
ms.locfileid: "100434435"
---
# <a name="delegates-visual-basic"></a><span data-ttu-id="c1b15-103">대리자(Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="c1b15-103">Delegates (Visual Basic)</span></span>

<span data-ttu-id="c1b15-104">대리자는 메서드를 참조하는 개체입니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-104">Delegates are objects that refer to methods.</span></span> <span data-ttu-id="c1b15-105">다른 프로그래밍 언어에서 사용되는 함수 포인터와 비슷하기 때문에 *형식 안전 함수 포인터* 라고도 합니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-105">They are sometimes described as *type-safe function pointers* because they are similar to function pointers used in other programming languages.</span></span> <span data-ttu-id="c1b15-106">그러나 함수 포인터와는 달리 Visual Basic 대리자는 클래스를 기반으로 하는 참조 형식 <xref:System.Delegate?displayProperty=nameWithType> 입니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-106">But unlike function pointers, Visual Basic delegates are a reference type based on the class <xref:System.Delegate?displayProperty=nameWithType>.</span></span> <span data-ttu-id="c1b15-107">대리자는 공유 메서드(클래스의 특정 인스턴스 없이 호출할 수 있는 메서드) 및 인스턴스 메서드를 둘 다 참조할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-107">Delegates can reference both shared methods — methods that can be called without a specific instance of a class — and instance methods.</span></span>

## <a name="delegates-and-events"></a><span data-ttu-id="c1b15-108">대리자 및 이벤트</span><span class="sxs-lookup"><span data-stu-id="c1b15-108">Delegates and Events</span></span>

<span data-ttu-id="c1b15-109">대리자는 호출 프로시저와 호출되는 프로시저 간에 중개자가 필요한 경우에 유용합니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-109">Delegates are useful in situations where you need an intermediary between a calling procedure and the procedure being called.</span></span> <span data-ttu-id="c1b15-110">예를 들어 다양한 상황에서 다른 이벤트 처리기를 호출하도록 하는 이벤트를 발생시키는 개체를 원할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-110">For example, you might want an object that raises events to be able to call different event handlers under different circumstances.</span></span> <span data-ttu-id="c1b15-111">그러나 이벤트를 발생시키는 개체는 특정 이벤트를 처리할 이벤트 처리기가 어느 것인지를 미리 알 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-111">Unfortunately, the object raising the events cannot know ahead of time which event handler is handling a specific event.</span></span> <span data-ttu-id="c1b15-112">Visual Basic를 사용 하면 문을 사용할 때 대리자를 만들어 이벤트에 이벤트 처리기를 동적으로 연결할 수 있습니다 `AddHandler` .</span><span class="sxs-lookup"><span data-stu-id="c1b15-112">Visual Basic lets you dynamically associate event handlers with events by creating a delegate for you when you use the `AddHandler` statement.</span></span> <span data-ttu-id="c1b15-113">런타임 시 대리자는 적절한 이벤트 처리기로 호출을 전달합니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-113">At run time, the delegate forwards calls to the appropriate event handler.</span></span>

<span data-ttu-id="c1b15-114">사용자 고유의 대리자를 만들 수는 있지만 대부분의 경우 Visual Basic는 대리자를 만들고 사용자에 대 한 세부 정보를 처리 합니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-114">Although you can create your own delegates, in most cases Visual Basic creates the delegate and takes care of the details for you.</span></span> <span data-ttu-id="c1b15-115">예를 들어 `Event` 문은 `<EventName>EventHandler`라는 대리자 클래스를 `Event` 문을 포함하고 이벤트와 시그니처가 같은 클래스의 중첩 클래스로 암시적으로 정의합니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-115">For example, an `Event` statement implicitly defines a delegate class named `<EventName>EventHandler` as a nested class of the class containing the `Event` statement, and with the same signature as the event.</span></span> <span data-ttu-id="c1b15-116">`AddressOf` 문은 특정 프로시저를 참조하는 대리자의 인스턴스를 암시적으로 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-116">The `AddressOf` statement implicitly creates an instance of a delegate that refers to a specific procedure.</span></span> <span data-ttu-id="c1b15-117">다음 두 코드 줄은 동일한 의미를 갖습니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-117">The following two lines of code are equivalent.</span></span> <span data-ttu-id="c1b15-118">첫 번째 줄에서는 `Button1_Click` 메서드에 대한 참조가 인수로 전달된 `EventHandler`의 인스턴스를 명시적으로 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-118">In the first line, you see the explicit creation of an instance of `EventHandler`, with a reference to method `Button1_Click` sent as the argument.</span></span> <span data-ttu-id="c1b15-119">두 번째 줄은 동일한 작업을 좀 더 편리하게 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-119">The second line is a more convenient way to do the same thing.</span></span>

[!code-vb[VbVbalrDelegates#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDelegates/VB/Class1.vb#6)]

<span data-ttu-id="c1b15-120">컴파일러가 어디에서든지 상황에 따라 대리자의 형식을 결정할 수 있도록 대리자를 만드는 간단한 방법을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-120">You can use the shorthand way of creating delegates anywhere the compiler can determine the delegate's type by the context.</span></span>

## <a name="declaring-events-that-use-an-existing-delegate-type"></a><span data-ttu-id="c1b15-121">기존 대리자 형식을 사용하는 이벤트 선언</span><span class="sxs-lookup"><span data-stu-id="c1b15-121">Declaring Events that Use an Existing Delegate Type</span></span>

<span data-ttu-id="c1b15-122">일부 경우에 기존 대리자 형식을 내부 대리자로 사용하도록 이벤트를 선언하려고 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-122">In some situations, you may want to declare an event to use an existing delegate type as its underlying delegate.</span></span> <span data-ttu-id="c1b15-123">다음 구문에 해당 방법이 나와 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-123">The following syntax demonstrates how:</span></span>

[!code-vb[VbVbalrDelegates#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDelegates/VB/Class1.vb#7)]

<span data-ttu-id="c1b15-124">동일한 처리기로 여러 이벤트 라우팅하려는 경우에 유용합니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-124">This is useful when you want to route multiple events to the same handler.</span></span>

## <a name="delegate-variables-and-parameters"></a><span data-ttu-id="c1b15-125">대리자 변수 및 매개 변수</span><span class="sxs-lookup"><span data-stu-id="c1b15-125">Delegate Variables and Parameters</span></span>

<span data-ttu-id="c1b15-126">빈 스레드 또는 런타임에 다른 버전의 함수를 호출해야 하는 프로시저 등, 이벤트와 관련되지 않은 다른 작업에 대리자를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-126">You can use delegates for other, non-event related tasks, such as free threading or with procedures that need to call different versions of functions at run time.</span></span>

<span data-ttu-id="c1b15-127">예를 들어 자동차 이름에 목록 상자를 포함하는 광고 애플리케이션을 분류한다고 가정합니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-127">For example, suppose you have a classified-ad application that includes a list box with the names of cars.</span></span> <span data-ttu-id="c1b15-128">광고는 일반적으로 자동차 제조업체에 해당하는 제목별로 정렬됩니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-128">The ads are sorted by title, which is normally the make of the car.</span></span> <span data-ttu-id="c1b15-129">일부 자동차의 제조업체 앞에 자동차 연식이 포함되어 있을 때 문제가 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-129">A problem you may face occurs when some cars include the year of the car before the make.</span></span> <span data-ttu-id="c1b15-130">문제는 목록 상자의 기본 제공 정렬 기능이 문자 코드를 기준으로만 정렬된다는 것입니다. 즉, 모든 광고는 날짜 순서로 배치된 다음 제조업체 순서로 정렬됩니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-130">The problem is that the built-in sort functionality of the list box sorts only by character codes; it places all the ads starting with dates first, followed by the ads starting with the make.</span></span>

<span data-ttu-id="c1b15-131">이 문제를 해결하려면 대부분의 목록 상자에 대해 표준 사전순 정렬을 사용하지만 자동차 광고의 경우는 런타임에 사용자 지정 정렬 프로시저로 전환할 수 있는 정렬 프로시저를 클래스에 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-131">To fix this, you can create a sort procedure in a class that uses the standard alphabetic sort on most list boxes, but is able to switch at run time to the custom sort procedure for car ads.</span></span> <span data-ttu-id="c1b15-132">이렇게 하려면 대리자를 사용하여 런타임에 정렬 클래스에 사용자 지정 정렬 프로시저를 전달합니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-132">To do this, you pass the custom sort procedure to the sort class at run time, using delegates.</span></span>

## <a name="addressof-and-lambda-expressions"></a><span data-ttu-id="c1b15-133">AddressOf 및 람다 식</span><span class="sxs-lookup"><span data-stu-id="c1b15-133">AddressOf and Lambda Expressions</span></span>

<span data-ttu-id="c1b15-134">각 대리자 클래스는 개체 메서드의 사양이 전달되는 생성자를 정의합니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-134">Each delegate class defines a constructor that is passed the specification of an object method.</span></span> <span data-ttu-id="c1b15-135">대리자 생성자에 대한 인수는 메서드 또는 람다 식에 대한 참조여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-135">An argument to a delegate constructor must be a reference to a method, or a lambda expression.</span></span>

<span data-ttu-id="c1b15-136">메서드에 대한 참조를 지정하려면 다음 구문을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-136">To specify a reference to a method, use the following syntax:</span></span>

<span data-ttu-id="c1b15-137">`AddressOf` [`expression`.]`methodName`</span><span class="sxs-lookup"><span data-stu-id="c1b15-137">`AddressOf` [`expression`.]`methodName`</span></span>

<span data-ttu-id="c1b15-138">`expression`의 컴파일 타임 형식은 해당 시그니처가 대리자 클래스의 시그니처와 일치하는 지정된 이름의 메서드를 포함하는 클래스 또는 인터페이스의 이름이어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-138">The compile-time type of the `expression` must be the name of a class or an interface that contains a method of the specified name whose signature matches the signature of the delegate class.</span></span> <span data-ttu-id="c1b15-139">`methodName`은 공유 메서드이거나 인스턴스 메서드일 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-139">The `methodName` can be either a shared method or an instance method.</span></span> <span data-ttu-id="c1b15-140">`methodName`은 클래스의 기본 메서드에 대해 대리자를 만들더라도 선택 사항이 아닙니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-140">The `methodName` is not optional, even if you create a delegate for the default method of the class.</span></span>

<span data-ttu-id="c1b15-141">람다 식을 지정하려면 다음 구문을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-141">To specify a lambda expression, use the following syntax:</span></span>

<span data-ttu-id="c1b15-142">`Function` ([`parm` As `type`, `parm2` As `type2`, ...]) `expression`</span><span class="sxs-lookup"><span data-stu-id="c1b15-142">`Function` ([`parm` As `type`, `parm2` As `type2`, ...]) `expression`</span></span>

<span data-ttu-id="c1b15-143">다음 예제에서는 대리자에 대한 참조를 지정하는 데 사용되는 `AddressOf` 및 람다 식을 둘 다 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-143">The following example shows both `AddressOf` and lambda expressions used to specify the reference for a delegate.</span></span>

[!code-vb[VbVbalrDelegates#15](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDelegates/VB/Class2.vb#15)]

<span data-ttu-id="c1b15-144">함수의 시그니처는 대리자 형식의 시그니처와 일치해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-144">The signature of the function must match that of the delegate type.</span></span> <span data-ttu-id="c1b15-145">람다 식에 대 한 자세한 내용은 [람다 식](../procedures/lambda-expressions.md)을 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="c1b15-145">For more information about lambda expressions, see [Lambda Expressions](../procedures/lambda-expressions.md).</span></span> <span data-ttu-id="c1b15-146">대리자에 대한 람다 식 및 `AddressOf` 대입의 추가 예제를 보려면 [완화된 대리자 변환](relaxed-delegate-conversion.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="c1b15-146">For more examples of lambda expression and `AddressOf` assignments to delegates, see [Relaxed Delegate Conversion](relaxed-delegate-conversion.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="c1b15-147">관련 항목</span><span class="sxs-lookup"><span data-stu-id="c1b15-147">Related Topics</span></span>

|<span data-ttu-id="c1b15-148">제목</span><span class="sxs-lookup"><span data-stu-id="c1b15-148">Title</span></span>|<span data-ttu-id="c1b15-149">설명</span><span class="sxs-lookup"><span data-stu-id="c1b15-149">Description</span></span>|
|-----------|-----------------|
|[<span data-ttu-id="c1b15-150">방법: 대리자 메서드 호출</span><span class="sxs-lookup"><span data-stu-id="c1b15-150">How to: Invoke a Delegate Method</span></span>](how-to-invoke-a-delegate-method.md)|<span data-ttu-id="c1b15-151">메서드를 대리자를 연결하고 대리자를 통해 해당 메서드를 호출하는 방법을 보여 주는 예제를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-151">Provides an example that shows how to associate a method with a delegate and then invoke that method through the delegate.</span></span>|
|[<span data-ttu-id="c1b15-152">방법: Visual Basic에서 프로시저에 다른 프로시저 전달</span><span class="sxs-lookup"><span data-stu-id="c1b15-152">How to: Pass Procedures to Another Procedure in Visual Basic</span></span>](how-to-pass-procedures-to-another-procedure.md)|<span data-ttu-id="c1b15-153">대리자를 사용하여 한 프로시저를 다른 프로시저에 전달하는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-153">Demonstrates how to use delegates to pass one procedure to another procedure.</span></span>|
|[<span data-ttu-id="c1b15-154">완화된 대리자 변환</span><span class="sxs-lookup"><span data-stu-id="c1b15-154">Relaxed Delegate Conversion</span></span>](relaxed-delegate-conversion.md)|<span data-ttu-id="c1b15-155">시그니처가 동일하지 않더라도 sub 및 함수를 대리자 또는 처리기에 할당하는 방법을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-155">Describes how you can assign subs and functions to delegates or handlers even when their signatures are not identical</span></span>|
|[<span data-ttu-id="c1b15-156">이벤트</span><span class="sxs-lookup"><span data-stu-id="c1b15-156">Events</span></span>](../events/index.md)|<span data-ttu-id="c1b15-157">Visual Basic의 이벤트에 대해 간략하게 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="c1b15-157">Provides an overview of events in Visual Basic.</span></span>|
