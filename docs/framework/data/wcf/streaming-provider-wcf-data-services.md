---
description: '자세한 정보: 스트리밍 공급자 (WCF Data Services)'
title: 스트리밍 공급자(WCF Data Services)
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- WCF Data Services, providers
- WCF Data Services, binary data
- streaming data provider [WCF Data Services]
- WCF Data Services, streams
ms.assetid: f0978fe4-5f9f-42aa-a5c2-df395d7c9495
ms.openlocfilehash: a87cd0764156e803bf30520160b54f6baaf4f644
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 02/06/2021
ms.locfileid: "99791740"
---
# <a name="streaming-provider-wcf-data-services"></a><span data-ttu-id="37a4b-103">스트리밍 공급자(WCF Data Services)</span><span class="sxs-lookup"><span data-stu-id="37a4b-103">Streaming Provider (WCF Data Services)</span></span>

[!INCLUDE [wcf-deprecated](~/includes/wcf-deprecated.md)]

<span data-ttu-id="37a4b-104">데이터 서비스에서 BLOB(Binary Large Object) 데이터를 노출할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-104">A data service can expose large object binary data.</span></span> <span data-ttu-id="37a4b-105">이 이진 데이터는 비디오 및 오디오 스트림, 이미지, 문서 파일 또는 다른 형식의 이진 미디어를 나타낼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-105">This binary data might represent video and audio streams, images, document files, or other types of binary media.</span></span> <span data-ttu-id="37a4b-106">데이터 모델의 엔터티에 이진 속성이 하나 이상 포함되어 있는 경우 데이터 서비스가 이 이진 데이터를 응답 피드의 항목 안에 base-64로 인코딩하여 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-106">When an entity in the data model includes one or more binary properties, the data service returns this binary data encoded as base-64 inside the entry in the response feed.</span></span> <span data-ttu-id="37a4b-107">이러한 방식으로 많은 이진 데이터를 로드 하 고 serialize 하면 성능에 영향을 줄 수 있으므로 OData (Open Data Protocol)는 자신이 속한 엔터티와 독립적으로 이진 데이터를 검색 하기 위한 메커니즘을 정의 합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-107">Because loading and serializing large binary data in this manner can affect performance, the Open Data Protocol (OData) defines a mechanism for retrieving binary data independent of the entity to which it belongs.</span></span> <span data-ttu-id="37a4b-108">이 작업은 엔터티의 이진 데이터를 하나 이상의 데이터 스트림으로 구분하여 수행됩니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-108">This is accomplished by separating the binary data from the entity into one or more data streams.</span></span>

- <span data-ttu-id="37a4b-109">미디어 리소스-비디오, 오디오, 이미지 또는 다른 유형의 미디어 리소스 스트림과 같은 엔터티에 속하는 이진 데이터입니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-109">Media resource - binary data that belongs to an entity, such as a video, audio, image, or other type of media resource stream.</span></span>

- <span data-ttu-id="37a4b-110">미디어 링크 항목 - 관련 미디어 리소스 스트림에 대한 참조가 있는 엔터티입니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-110">Media link entry - an entity that has a reference to a related media resource stream.</span></span>

<span data-ttu-id="37a4b-111">WCF Data Services를 사용 하 여 스트리밍 데이터 공급자를 구현 하 여 이진 리소스 스트림을 정의 합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-111">With WCF Data Services, you define a binary resource stream by implementing a streaming data provider.</span></span> <span data-ttu-id="37a4b-112">스트리밍 공급자 구현에서는 특정 엔터티와 연결 된 미디어 리소스 스트림과 함께 데이터 서비스를 <xref:System.IO.Stream> 개체로 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-112">The streaming provider implementation supplies the data service with the media resource stream associated with a specific entity as an <xref:System.IO.Stream> object.</span></span> <span data-ttu-id="37a4b-113">이 구현을 사용하면 데이터 서비스가 HTTP를 통해 미디어 리소스를 받아들이고 지정된 MIME 형식의 이진 데이터 스트림으로 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-113">This implementation enables the data service to accept and return media resources over HTTP as binary data streams of a specified MIME type.</span></span>

<span data-ttu-id="37a4b-114">이진 데이터의 스트리밍을 지원하도록 데이터 서비스를 구성하려면 다음 단계를 수행해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-114">Configuring a data service to support the streaming of binary data requires the following steps:</span></span>

1. <span data-ttu-id="37a4b-115">데이터 모델에서 하나 이상의 엔터티 특성을 미디어 링크 항목으로 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-115">Attribute one or more entities in the data model as a media link entry.</span></span> <span data-ttu-id="37a4b-116">이러한 엔터티에는 스트리밍할 이진 데이터가 포함되면 안 됩니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-116">These entities should not include the binary data to be streamed.</span></span> <span data-ttu-id="37a4b-117">엔터티의 모든 이진 속성은 항상 base-64로 인코딩된 이진 데이터로 항목에 반환됩니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-117">Any binary properties of an entity are always returned in the entry as base-64 encoded binary.</span></span>

2. <span data-ttu-id="37a4b-118">T:System.Data.Services.Providers.IDataServiceStreamProvider 인터페이스를 구현합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-118">Implement the T:System.Data.Services.Providers.IDataServiceStreamProvider interface.</span></span>

3. <span data-ttu-id="37a4b-119"><xref:System.IServiceProvider> 인터페이스를 구현하는 데이터 서비스를 정의합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-119">Define a data service that implements the <xref:System.IServiceProvider> interface.</span></span> <span data-ttu-id="37a4b-120">데이터 서비스는 <xref:System.IServiceProvider.GetService%2A> 구현을 사용하여 스트리밍 데이터 공급자 구현에 액세스합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-120">The data service uses the <xref:System.IServiceProvider.GetService%2A> implementation to access the streaming data provider implementation.</span></span> <span data-ttu-id="37a4b-121">이 메서드는 적절한 스트리밍 공급자 구현을 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-121">This method returns the appropriate streaming provider implementation.</span></span>

4. <span data-ttu-id="37a4b-122">웹 애플리케이션 구성에서 큰 메시지 스트림을 사용하도록 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-122">Enable large message streams in the Web application configuration.</span></span>

5. <span data-ttu-id="37a4b-123">서버나 데이터 소스의 이진 리소스에 대한 액세스를 사용하도록 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-123">Enable access to binary resources on the server or in a data source.</span></span>

<span data-ttu-id="37a4b-124">이 항목의 예제는 스트리밍 공급자 [시리즈: 스트리밍 공급자 구현 (1 부) 게시물 Data Services](/archive/blogs/astoriateam/data-services-streaming-provider-series-implementing-a-streaming-provider-part-1)에서 자세히 설명 하는 샘플 스트리밍 사진 서비스를 기반으로 합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-124">The examples in this topic are based on a sample streaming photo service, which is discussed in depth in the post [Data Services Streaming Provider Series: Implementing a Streaming Provider (Part 1)](/archive/blogs/astoriateam/data-services-streaming-provider-series-implementing-a-streaming-provider-part-1).</span></span> <span data-ttu-id="37a4b-125">스트리밍 사진 데이터 서비스 샘플의 소스 코드는 [GitHub](https://github.com/microsoftarchive/msdn-code-gallery-community-s-z/tree/master/Streaming%20Photo%20OData%20Service%20Sample)에서 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-125">The source code for the Streaming Photo Data Service sample is available on [GitHub](https://github.com/microsoftarchive/msdn-code-gallery-community-s-z/tree/master/Streaming%20Photo%20OData%20Service%20Sample).</span></span>

## <a name="defining-a-media-link-entry-in-the-data-model"></a><span data-ttu-id="37a4b-126">데이터 모델에서 미디어 링크 항목 정의</span><span class="sxs-lookup"><span data-stu-id="37a4b-126">Defining a Media Link Entry in the Data Model</span></span>

<span data-ttu-id="37a4b-127">데이터 소스 공급자는 엔터티가 데이터 모델에서 미디어 링크 항목으로 정의되는 방식을 결정합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-127">The data source provider determines the way that an entity is defined as a media link entry in the data model.</span></span>

<span data-ttu-id="37a4b-128">**Entity Framework 공급자**</span><span class="sxs-lookup"><span data-stu-id="37a4b-128">**Entity Framework Provider**</span></span>

<span data-ttu-id="37a4b-129">엔터티가 미디어 링크 항목임을 나타내려면 다음 예제와 같이 개념적 모델의 엔터티 형식 정의에 `HasStream` 특성을 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-129">To indicate that an entity is a media link entry, add the `HasStream` attribute to the entity type definition in the conceptual model, as in the following example:</span></span>

[!code-xml[Astoria Photo Streaming Service#HasStream](../../../../samples/snippets/xml/VS_Snippets_Misc/astoria_photo_streaming_service/xml/photodata.edmx#hasstream)]

<span data-ttu-id="37a4b-130">또한 데이터 모델을 정의하는 .edmx 또는 .csdl 파일의 루트나 엔터티에 `xmlns:m=http://schemas.microsoft.com/ado/2007/08/dataservices/metadata` 네임스페이스를 추가해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-130">You must also add the namespace `xmlns:m=http://schemas.microsoft.com/ado/2007/08/dataservices/metadata` either to the entity or to the root of the .edmx or .csdl file that defines the data model.</span></span>

<span data-ttu-id="37a4b-131">Entity Framework 공급자를 사용 하 고 미디어 리소스를 노출 하는 데이터 서비스의 예제는 스트리밍 [공급자 시리즈: 스트리밍 공급자 구현 (1 부) Data Services](/archive/blogs/astoriateam/data-services-streaming-provider-series-implementing-a-streaming-provider-part-1)게시를 참조 하십시오.</span><span class="sxs-lookup"><span data-stu-id="37a4b-131">For an example of a data service that uses the Entity Framework provider and exposes a media resource, see the post [Data Services Streaming Provider Series: Implementing a Streaming Provider (Part 1)](/archive/blogs/astoriateam/data-services-streaming-provider-series-implementing-a-streaming-provider-part-1).</span></span>

<span data-ttu-id="37a4b-132">**리플렉션 공급자**</span><span class="sxs-lookup"><span data-stu-id="37a4b-132">**Reflection Provider**</span></span>

<span data-ttu-id="37a4b-133">엔터티가 미디어 링크 항목임을 나타내려면 리플렉션 공급자에서 엔터티 형식을 정의하는 클래스에 <xref:System.Data.Services.Common.HasStreamAttribute>를 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-133">To indicate that an entity is a media link entry, add the <xref:System.Data.Services.Common.HasStreamAttribute> to the class that defines the entity type in the reflection provider.</span></span>

<span data-ttu-id="37a4b-134">**사용자 지정 데이터 서비스 공급자**</span><span class="sxs-lookup"><span data-stu-id="37a4b-134">**Custom Data Service Provider**</span></span>

<span data-ttu-id="37a4b-135">사용자 지정 서비스 공급자를 사용하는 경우 <xref:System.Data.Services.Providers.IDataServiceMetadataProvider> 인터페이스를 구현하여 데이터 서비스에 대한 메타데이터를 정의합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-135">When using custom service providers, you implement the <xref:System.Data.Services.Providers.IDataServiceMetadataProvider> interface to define the metadata for your data service.</span></span> <span data-ttu-id="37a4b-136">자세한 내용은 [사용자 지정 데이터 서비스 공급자](custom-data-service-providers-wcf-data-services.md)를 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="37a4b-136">For more information, see [Custom Data Service Providers](custom-data-service-providers-wcf-data-services.md).</span></span> <span data-ttu-id="37a4b-137">미디어 링크 항목인 엔터티 형식을 나타내는 <xref:System.Data.Services.Providers.ResourceType>에서 <xref:System.Data.Services.Providers.ResourceType.IsMediaLinkEntry%2A> 속성을 `true`로 설정하여 이진 리소스 스트림이 <xref:System.Data.Services.Providers.ResourceType>에 속해 있음을 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-137">You indicate that a binary resource stream belongs to a <xref:System.Data.Services.Providers.ResourceType> by setting the <xref:System.Data.Services.Providers.ResourceType.IsMediaLinkEntry%2A> property to `true` on the <xref:System.Data.Services.Providers.ResourceType> that represents the entity type, which is a media link entry.</span></span>

## <a name="implementing-the-idataservicestreamprovider-interface"></a><span data-ttu-id="37a4b-138">IDataServiceStreamProvider 인터페이스 구현</span><span class="sxs-lookup"><span data-stu-id="37a4b-138">Implementing the IDataServiceStreamProvider Interface</span></span>

<span data-ttu-id="37a4b-139">이진 데이터 스트림을 지원하는 데이터 서비스를 만들려면 <xref:System.Data.Services.Providers.IDataServiceStreamProvider> 인터페이스를 구현해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-139">To create a data service that supports binary data streams, you must implement the <xref:System.Data.Services.Providers.IDataServiceStreamProvider> interface.</span></span> <span data-ttu-id="37a4b-140">이 구현을 통해 데이터 서비스에서 이진 데이터를 스트림으로 클라이언트에 반환하고 클라이언트에서 전송되는 스트림으로 이진 데이터를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-140">This implementation enables the data service to return binary data as a stream to the client and consume binary data as a stream sent from the client.</span></span> <span data-ttu-id="37a4b-141">데이터 서비스는 스트림으로 이진 데이터에 액세스해야 할 때마다 이 인터페이스의 인스턴스를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-141">The data service creates an instance of this interface whenever it needs to access binary data as a stream.</span></span> <span data-ttu-id="37a4b-142"><xref:System.Data.Services.Providers.IDataServiceStreamProvider> 인터페이스는 다음 멤버를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-142">The <xref:System.Data.Services.Providers.IDataServiceStreamProvider> interface specifies the following members:</span></span>

|<span data-ttu-id="37a4b-143">멤버 이름</span><span class="sxs-lookup"><span data-stu-id="37a4b-143">Member name</span></span>|<span data-ttu-id="37a4b-144">설명</span><span class="sxs-lookup"><span data-stu-id="37a4b-144">Description</span></span>|
|-----------------|-----------------|
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.DeleteStream%2A>|<span data-ttu-id="37a4b-145">이 메서드는 미디어 링크 항목이 삭제될 때 해당 미디어 리소스를 삭제하기 위해 데이터 서비스에서 호출됩니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-145">This method is invoked by the data service to delete the corresponding media resource when its media link entry is deleted.</span></span> <span data-ttu-id="37a4b-146"><xref:System.Data.Services.Providers.IDataServiceStreamProvider>를 구현하는 경우 이 메서드에는 제공된 미디어 링크 항목과 연결된 미디어 리소스를 삭제하는 코드가 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-146">When you implement <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, this method contains the code that deletes the media resource associated with the supplied media link entry.</span></span>|
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetReadStream%2A>|<span data-ttu-id="37a4b-147">이 메서드는 미디어 리소스를 스트림으로 반환하기 위해 데이터 서비스에서 호출됩니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-147">This method is invoked by the data service to return a media resource as a stream.</span></span> <span data-ttu-id="37a4b-148"><xref:System.Data.Services.Providers.IDataServiceStreamProvider>를 구현하는 경우 이 메서드에는 제공된 미디어 링크 항목과 연결된 미디어 리소스를 반환하기 위해 데이터 서비스에서 사용되는 스트림을 제공하는 코드가 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-148">When you implement <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, this method contains the code that provides a stream that is used by the data service to the return media resource that is associated with the provided media link entry.</span></span>|
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetReadStreamUri%2A>|<span data-ttu-id="37a4b-149">이 메서드는 미디어 링크 항목의 미디어 리소스를 요청하는 데 사용되는 URI를 반환하기 위해 데이터 서비스에서 호출됩니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-149">This method is invoked by the data service to return the URI that is used to request the media resource for the media link entry.</span></span> <span data-ttu-id="37a4b-150">이 값은 미디어 링크 항목의 콘텐츠 요소에서 데이터 스트림을 요청할 때 사용되는 `src` 특성을 만드는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-150">This value is used to create the `src` attribute in the content element of the media link entry and that is used to request the data stream.</span></span> <span data-ttu-id="37a4b-151">이 메서드가 `null`을 반환하면 데이터 서비스에서 자동으로 URI를 결정합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-151">When this method returns `null`, the data service automatically determines the URI.</span></span> <span data-ttu-id="37a4b-152">스트림 공급자를 사용하지 않고 이진 데이터에 직접 액세스할 수 있는 권한을 클라이언트에 제공해야 할 때 이 메서드를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-152">Use this method when you need to provide clients with direct access to binary data without using the steam provider.</span></span>|
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetStreamContentType%2A>|<span data-ttu-id="37a4b-153">이 메서드는 지정된 미디어 링크 항목과 연결된 미디어 리소스의 Content-Type 값을 반환하기 위해 데이터 서비스에서 호출됩니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-153">This method is invoked by the data service to return the Content-Type value of the media resource that is associated with the specified media link entry.</span></span>|
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetStreamETag%2A>|<span data-ttu-id="37a4b-154">이 메서드는 지정된 엔터티와 연결된 데이터 스트림의 eTag를 반환하기 위해 데이터 서비스에서 호출됩니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-154">This method is invoked by the data service to return the eTag of the data stream that is associated with the specified entity.</span></span> <span data-ttu-id="37a4b-155">이 메서드는 이진 데이터의 동시성을 관리할 때 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-155">This method is used when you manage concurrency for the binary data.</span></span> <span data-ttu-id="37a4b-156">이 메서드가 null을 반환하는 경우 데이터 서비스는 동시성을 추적하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-156">When this method returns null, the data service does not track concurrency.</span></span>|
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A>|<span data-ttu-id="37a4b-157">이 메서드는 클라이언트에서 전송된 스트림을 받을 때 사용되는 스트림을 가져오기 위해 데이터 서비스에서 호출됩니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-157">This method is invoked by the data service to obtain the stream that is used when receiving the stream sent from the client.</span></span> <span data-ttu-id="37a4b-158"><xref:System.Data.Services.Providers.IDataServiceStreamProvider>를 구현하는 경우 데이터 서비스가 수신된 스트림 데이터를 쓰는 쓰기 가능한 스트림을 반환해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-158">When you implement <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, you must return a writable stream to which the data service writes received stream data.</span></span>|
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.ResolveType%2A>|<span data-ttu-id="37a4b-159">삽입될 미디어 리소스의 데이터 스트림과 연결된 미디어 링크 항목에 대해 데이터 서비스 런타임이 만들어야 하는 형식을 나타내는 네임스페이스로 한정된 형식 이름을 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-159">Returns a namespace-qualified type name that represents the type that the data service runtime must create for the media link entry that is associated with the data stream for the media resource that is being inserted.</span></span>|

## <a name="creating-the-streaming-data-service"></a><span data-ttu-id="37a4b-160">스트리밍 데이터 서비스 만들기</span><span class="sxs-lookup"><span data-stu-id="37a4b-160">Creating the Streaming Data Service</span></span>

<span data-ttu-id="37a4b-161">구현에 대 한 액세스 권한을 WCF Data Services 런타임에 제공 하기 위해 <xref:System.Data.Services.Providers.IDataServiceStreamProvider> 사용자가 만든 데이터 서비스에서 인터페이스도 구현 해야 합니다 <xref:System.IServiceProvider> .</span><span class="sxs-lookup"><span data-stu-id="37a4b-161">To provide the WCF Data Services runtime with access to the <xref:System.Data.Services.Providers.IDataServiceStreamProvider> implementation, the data service that you create must also implement the <xref:System.IServiceProvider> interface.</span></span> <span data-ttu-id="37a4b-162">다음 예제에서는 <xref:System.IServiceProvider.GetService%2A>를 구현하는 `PhotoServiceStreamProvider` 클래스의 인스턴스를 반환하기 위해 <xref:System.Data.Services.Providers.IDataServiceStreamProvider> 메서드를 구현하는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-162">The following example shows how to implement the <xref:System.IServiceProvider.GetService%2A> method to return an instance of the `PhotoServiceStreamProvider` class that implements <xref:System.Data.Services.Providers.IDataServiceStreamProvider>.</span></span>

[!code-csharp[Astoria Photo Streaming Service#PhotoServiceStreamingProvider](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_photo_streaming_service/cs/photodata.svc.cs#photoservicestreamingprovider)]
[!code-vb[Astoria Photo Streaming Service#PhotoServiceStreamingProvider](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_photo_streaming_service/vb/photodata.svc.vb#photoservicestreamingprovider)]

<span data-ttu-id="37a4b-163">데이터 서비스를 만드는 방법에 대 한 일반적인 내용은 [데이터 서비스 구성](configuring-the-data-service-wcf-data-services.md)을 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="37a4b-163">For general information about how to create a data service, see [Configuring the Data Service](configuring-the-data-service-wcf-data-services.md).</span></span>

## <a name="enabling-large-binary-streams-in-the-hosting-environment"></a><span data-ttu-id="37a4b-164">호스팅 환경에서 큰 이진 스트림 사용</span><span class="sxs-lookup"><span data-stu-id="37a4b-164">Enabling Large Binary Streams in the Hosting Environment</span></span>

<span data-ttu-id="37a4b-165">ASP.NET 웹 응용 프로그램에서 데이터 서비스를 만들 때 WCF (Windows Communication Foundation)를 사용 하 여 HTTP 프로토콜 구현을 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-165">When you create a data service in an ASP.NET Web application, Windows Communication Foundation (WCF) is used to provide the HTTP protocol implementation.</span></span> <span data-ttu-id="37a4b-166">기본적으로 WCF는 HTTP 메시지의 크기를 65 KB로 제한 합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-166">By default, WCF limits the size of HTTP messages to only 65 KB.</span></span> <span data-ttu-id="37a4b-167">데이터 서비스에서 보내고 받는 큰 이진 데이터를 스트리밍할 수 있으려면 큰 이진 파일을 사용할 수 있고 전송에 스트림을 사용하도록 웹 애플리케이션도 구성해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-167">To be able to stream large binary data to and from the data service, you must also configure the Web application to enable large binary files and to use streams for transfer.</span></span> <span data-ttu-id="37a4b-168">이렇게 하려면 애플리케이션의 Web.config 파일에 있는 `<configuration />` 요소에 다음을 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-168">To do this, add the following in the `<configuration />` element of the application's Web.config file:</span></span>

> [!NOTE]
> <span data-ttu-id="37a4b-169">전송 모드를 사용 <xref:System.ServiceModel.TransferMode.Streamed?displayProperty=nameWithType> 하 여 요청 및 응답 메시지의 이진 데이터를 스트리밍하 고 WCF에 의해 버퍼링 되지 않았는지 확인 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-169">You must use a <xref:System.ServiceModel.TransferMode.Streamed?displayProperty=nameWithType> transfer mode to ensure that the binary data in both the request and response messages are streamed and not buffered by WCF.</span></span>

<span data-ttu-id="37a4b-170">자세한 내용은 [스트리밍 메시지 전송](../../wcf/feature-details/streaming-message-transfer.md) 및 [전송 할당량](../../wcf/feature-details/transport-quotas.md)을 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="37a4b-170">For more information, see [Streaming Message Transfer](../../wcf/feature-details/streaming-message-transfer.md) and [Transport Quotas](../../wcf/feature-details/transport-quotas.md).</span></span>

<span data-ttu-id="37a4b-171">기본적으로 인터넷 정보 서비스 (IIS)는 요청 크기를 4mb로 제한 합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-171">By default, Internet Information Services (IIS) also limits the size of requests to 4 MB.</span></span> <span data-ttu-id="37a4b-172">데이터 서비스에서 IIS를 실행 하는 동안 4mb 보다 큰 스트림을 수신 하도록 하려면 `maxRequestLength` 다음 예제와 같이 구성 섹션에서 [httpRuntime 요소 (ASP.NET Settings 스키마)](/previous-versions/dotnet/netframework-4.0/e1f13641(v=vs.100)) 의 특성도 설정 해야 합니다 `<system.web />` .</span><span class="sxs-lookup"><span data-stu-id="37a4b-172">To enable your data service to receive streams larger than 4 MB when running on IIS, you must also set the `maxRequestLength` attribute of the [httpRuntime Element (ASP.NET Settings Schema)](/previous-versions/dotnet/netframework-4.0/e1f13641(v=vs.100)) in the `<system.web />` configuration section, as shown in the following example:</span></span>

## <a name="using-data-streams-in-a-client-application"></a><span data-ttu-id="37a4b-173">클라이언트 애플리케이션에서 데이터 스트림 사용</span><span class="sxs-lookup"><span data-stu-id="37a4b-173">Using Data Streams in a Client Application</span></span>

<span data-ttu-id="37a4b-174">WCF Data Services 클라이언트 라이브러리를 사용 하면 클라이언트에서 이러한 노출 된 리소스를 이진 스트림으로 검색 하 고 업데이트할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-174">The WCF Data Services client library enables you to both retrieve and update these exposed resources as binary streams on the client.</span></span> <span data-ttu-id="37a4b-175">자세한 내용은 [이진 데이터 작업](working-with-binary-data-wcf-data-services.md)을 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="37a4b-175">For more information, see [Working with Binary Data](working-with-binary-data-wcf-data-services.md).</span></span>

## <a name="considerations-for-working-with-a-streaming-provider"></a><span data-ttu-id="37a4b-176">스트리밍 공급자로 작업하기 위한 고려 사항</span><span class="sxs-lookup"><span data-stu-id="37a4b-176">Considerations for Working with a Streaming Provider</span></span>

<span data-ttu-id="37a4b-177">스트리밍 공급자를 구현하는 경우와 데이터 서비스에서 미디어 리소스에 액세스하는 경우 고려할 사항은 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-177">The following are things to consider when you implement a streaming provider and when you access media resources from a data service.</span></span>

- <span data-ttu-id="37a4b-178">미디어 리소스에 대한 병합 요청은 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-178">MERGE requests are not supported for media resources.</span></span> <span data-ttu-id="37a4b-179">기존 엔터티의 미디어 리소스를 변경하려면 PUT 요청을 사용하세요.</span><span class="sxs-lookup"><span data-stu-id="37a4b-179">Use a PUT request to change the media resource of an existing entity.</span></span>

- <span data-ttu-id="37a4b-180">POST 요청을 사용하여 새 미디어 링크 항목을 만들 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-180">A POST request cannot be used to create a new media link entry.</span></span> <span data-ttu-id="37a4b-181">대신 POST 요청을 실행하여 새 미디어 리소스를 만들어야 하며, 이 경우 데이터 서비스에서 기본값을 사용하여 새 미디어 링크 항목을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-181">Instead, you must issue a POST request to create a new media resource, and the data service creates a new media link entry with default values.</span></span> <span data-ttu-id="37a4b-182">이 새 엔터티는 이후 병합 또는 PUT 요청으로 업데이트할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-182">This new entity can be updated by a subsequent MERGE or PUT request.</span></span> <span data-ttu-id="37a4b-183">또한 엔터티를 캐시하는 것을 고려할 수 있으며 속성 값을 POST 요청의 Slug 헤더 값으로 설정하는 등, 삭제기에서 업데이트를 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-183">You may also consider caching the entity and make updates in the disposer, such as setting the property value to the value of the Slug header in the POST request.</span></span>

- <span data-ttu-id="37a4b-184">POST 요청을 받으면 데이터 서비스는 <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A>를 호출하여 미디어 링크 항목을 만들기 전에 <xref:System.Data.Services.IUpdatable.SaveChanges%2A>을 호출하여 미디어 리소스를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-184">When a POST request is received, the data service calls <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> to create the media resource before it calls <xref:System.Data.Services.IUpdatable.SaveChanges%2A> to create the media link entry.</span></span>

- <span data-ttu-id="37a4b-185"><xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> 구현에서 <xref:System.IO.MemoryStream> 개체를 반환하면 안 됩니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-185">An implementation of <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> should not return a <xref:System.IO.MemoryStream> object.</span></span> <span data-ttu-id="37a4b-186">이러한 종류의 스트림을 사용하는 경우 서비스가 매우 큰 데이터 스트림을 받으면 메모리 리소스 문제가 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-186">When you use this kind of stream, memory resource issues will occur when the service receives very large data streams.</span></span>

- <span data-ttu-id="37a4b-187">데이터베이스에 미디어 리소스를 저장하는 경우 고려할 사항은 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-187">The following are things to consider when storing media resources in a database:</span></span>

  - <span data-ttu-id="37a4b-188">미디어 리소스인 이진 속성이 데이터 모델에 포함되면 안 됩니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-188">A binary property that is a media resource should not be included in the data model.</span></span> <span data-ttu-id="37a4b-189">데이터 모델에서 노출된 모든 속성은 응답 피드의 항목에 반환됩니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-189">All properties exposed in a data model are returned in the entry in a response feed.</span></span>

  - <span data-ttu-id="37a4b-190">큰 이진 스트림의 성능을 높이려면 사용자 지정 스트림 클래스를 만들어 데이터베이스에 이진 데이터를 저장하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-190">To improve performance with a large binary stream, we recommend that you create a custom stream class to store binary data in the database.</span></span> <span data-ttu-id="37a4b-191">이 클래스는 <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> 구현에 의해 반환되며 이진 데이터를 청크로 데이터베이스에 보냅니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-191">This class is returned by your <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> implementation and sends the binary data to the database in chunks.</span></span> <span data-ttu-id="37a4b-192">SQL Server 데이터베이스의 경우 이진 데이터가 1mb 보다 크면 FILESTREAM을 사용 하 여 데이터를 데이터베이스로 스트리밍하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-192">For a SQL Server database, we recommend that you use a FILESTREAM to stream data into the database when the binary data is larger than 1 MB.</span></span>

  - <span data-ttu-id="37a4b-193">사용하는 데이터베이스가 데이터 서비스를 통해 받을 큰 이진 스트림을 저장하도록 디자인되었는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-193">Ensure that your database is designed to store the binary large streams that are to be received by your data service.</span></span>

  - <span data-ttu-id="37a4b-194">클라이언트가 POST 요청을 보내 단일 요청에서 미디어 리소스와 함께 미디어 링크 항목을 삽입하면 <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A>이 호출되어 데이터 서비스가 새 엔터티를 데이터베이스에 삽입하기 전에 스트림을 가져옵니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-194">When a client sends a POST request to insert a media link entry with a media resource in a single request, <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> is called to obtain the stream before the data service inserts the new entity into the database.</span></span> <span data-ttu-id="37a4b-195">스트리밍 공급자 구현에서 이 데이터 서비스 동작을 처리할 수 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-195">A streaming provider implementation must be able to handle this data service behavior.</span></span> <span data-ttu-id="37a4b-196">엔터티가 데이터베이스에 삽입된 후까지 파일에 데이터 스트림을 저장하거나 이진 데이터를 저장하려면 별도의 데이터 테이블을 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-196">Consider using a separate data table to store the binary data or store the data stream in a file until after the entity has been inserted into the database.</span></span>

- <span data-ttu-id="37a4b-197"><xref:System.Data.Services.Providers.IDataServiceStreamProvider.DeleteStream%2A>, <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetReadStream%2A> 또는 <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> 메서드를 구현하는 경우 메서드 매개 변수로 제공되는 eTag 및 Content-Type 값을 사용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-197">When you implement the <xref:System.Data.Services.Providers.IDataServiceStreamProvider.DeleteStream%2A>, <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetReadStream%2A>, or <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> methods, you must use the eTag and Content-Type values that are supplied as method parameters.</span></span> <span data-ttu-id="37a4b-198"><xref:System.Data.Services.Providers.IDataServiceStreamProvider> 공급자 구현에서 eTag 또는 Content-Type 헤더를 설정하지 마세요.</span><span class="sxs-lookup"><span data-stu-id="37a4b-198">Do not set eTag or Content-Type headers in your <xref:System.Data.Services.Providers.IDataServiceStreamProvider> provider implementation.</span></span>

- <span data-ttu-id="37a4b-199">기본적으로 클라이언트는 청크된 HTTP Transfer-Encoding을 사용하여 큰 이진 스트림을 보냅니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-199">By default, the client sends large binary streams by using a chunked HTTP Transfer-Encoding.</span></span> <span data-ttu-id="37a4b-200">ASP.NET 개발 서버는 이러한 종류의 인코딩을 지원 하지 않으므로이 웹 서버를 사용 하 여 많은 이진 스트림을 허용 해야 하는 스트리밍 데이터 서비스를 호스트할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-200">Because the ASP.NET Development Server does not support this kind of encoding, you cannot use this Web server to host a streaming data service that must accept large binary streams.</span></span> <span data-ttu-id="37a4b-201">ASP.NET 개발 서버에 대 한 자세한 내용은 [Visual Studio에서 ASP.NET 웹 프로젝트용 웹 서버](/previous-versions/aspnet/58wxa9w5(v=vs.120))를 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="37a4b-201">For more information on ASP.NET Development Server, see [Web Servers in Visual Studio for ASP.NET Web Projects](/previous-versions/aspnet/58wxa9w5(v=vs.120)).</span></span>

<a name="versioning"></a>

## <a name="versioning-requirements"></a><span data-ttu-id="37a4b-202">버전 관리 요구 사항</span><span class="sxs-lookup"><span data-stu-id="37a4b-202">Versioning Requirements</span></span>

<span data-ttu-id="37a4b-203">스트리밍 공급자의 OData 프로토콜 버전 요구 사항은 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-203">The streaming provider has the following OData protocol versioning requirements:</span></span>

- <span data-ttu-id="37a4b-204">스트리밍 공급자는 데이터 서비스에서 OData 프로토콜 버전 2.0 이상 버전을 지원 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="37a4b-204">The streaming provider requires that the data service support version 2.0 of the OData protocol and later versions.</span></span>

<span data-ttu-id="37a4b-205">자세한 내용은 [데이터 서비스 버전 관리](data-service-versioning-wcf-data-services.md)를 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="37a4b-205">For more information, see [Data Service Versioning](data-service-versioning-wcf-data-services.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="37a4b-206">참고 항목</span><span class="sxs-lookup"><span data-stu-id="37a4b-206">See also</span></span>

- [<span data-ttu-id="37a4b-207">Data Services 공급자</span><span class="sxs-lookup"><span data-stu-id="37a4b-207">Data Services Providers</span></span>](data-services-providers-wcf-data-services.md)
- [<span data-ttu-id="37a4b-208">사용자 지정 데이터 서비스 공급자</span><span class="sxs-lookup"><span data-stu-id="37a4b-208">Custom Data Service Providers</span></span>](custom-data-service-providers-wcf-data-services.md)
- [<span data-ttu-id="37a4b-209">이진 데이터 사용</span><span class="sxs-lookup"><span data-stu-id="37a4b-209">Working with Binary Data</span></span>](working-with-binary-data-wcf-data-services.md)
