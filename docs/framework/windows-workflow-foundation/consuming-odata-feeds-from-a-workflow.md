---
description: '자세한 정보: 워크플로에서 OData 피드 사용'
title: 워크플로에서 OData 피드 사용-WF
ms.date: 03/30/2017
ms.assetid: 1b26617c-53e9-476a-81af-675c36d95919
ms.openlocfilehash: 8296fe912b1f40deb10670c5ef7ea24cf8fd47eb
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 02/06/2021
ms.locfileid: "99792728"
---
# <a name="consuming-odata-feeds-from-a-workflow"></a><span data-ttu-id="3d2d3-103">워크플로에서 OData 피드 사용</span><span class="sxs-lookup"><span data-stu-id="3d2d3-103">Consuming OData feeds from a workflow</span></span>

<span data-ttu-id="3d2d3-104">WCF Data Services는 Representational State Transfer (REST)의 의미 체계를 사용 하 여 웹 또는 인트라넷을 통해 데이터를 노출 하 고 사용 하는 데 Open Data Protocol (OData)를 사용 하는 서비스를 만들 수 있도록 하는 .NET Framework 구성 요소입니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-104">WCF Data Services is a component of the .NET Framework that enables you to create services that use the Open Data Protocol (OData) to expose and consume data over the Web or intranet by using the semantics of representational state transfer (REST).</span></span> <span data-ttu-id="3d2d3-105">OData는 URI로 주소를 지정할 수 있는 리소스로 데이터를 노출합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-105">OData exposes data as resources that are addressable by URIs.</span></span> <span data-ttu-id="3d2d3-106">HTTP 요청을 보내고 데이터 서비스에서 반환하는 OData 피드를 처리할 수 있는 애플리케이션은 모두 OData 기반 데이터 서비스와 상호 작용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-106">Any application can interact with an OData-based data service if it can send an HTTP request and process the OData feed that a data service returns.</span></span> <span data-ttu-id="3d2d3-107">또한 WCF Data Services에는 .NET Framework 응용 프로그램에서 OData 피드를 사용할 때 보다 다양 한 프로그래밍 환경을 제공 하는 클라이언트 라이브러리가 포함 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-107">In addition, WCF Data Services includes client libraries that provide a richer programming experience when you consume OData feeds from .NET Framework applications.</span></span> <span data-ttu-id="3d2d3-108">이 항목에서는 클라이언트 라이브러리를 사용하거나 사용하지 않고 워크플로에서 OData 피드를 사용하는 방법에 대해 간략하게 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-108">This topic provides an overview of consuming an OData feed in a workflow with and without using the client libraries.</span></span>

## <a name="using-the-sample-northwind-odata-service"></a><span data-ttu-id="3d2d3-109">Sample Northwind OData 서비스 사용</span><span class="sxs-lookup"><span data-stu-id="3d2d3-109">Using the sample Northwind OData service</span></span>

<span data-ttu-id="3d2d3-110">이 항목의 예제에서는에 있는 샘플 Northwind 데이터 서비스를 사용 합니다 <https://services.odata.org/Northwind/Northwind.svc/> .</span><span class="sxs-lookup"><span data-stu-id="3d2d3-110">The examples in this topic use the sample Northwind data service located at <https://services.odata.org/Northwind/Northwind.svc/>.</span></span> <span data-ttu-id="3d2d3-111">이 서비스는 [OData SDK](https://www.odata.org/ecosystem/#sdk) 의 일부로 제공되며 샘플 Northwind 데이터베이스에 읽기 전용으로 액세스할 수 있게 해줍니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-111">This service is provided as part of the [OData SDK](https://www.odata.org/ecosystem/#sdk) and provides read-only access to the sample Northwind database.</span></span> <span data-ttu-id="3d2d3-112">쓰기 권한이 필요하거나 로컬 WCF 데이터 서비스가 필요한 경우 [퀵 스타트(WCF Data Services)](../data/wcf/quickstart-wcf-data-services.md) 의 단계를 수행하여 Northwind 데이터베이스에 액세스할 수 있게 해 주는 로컬 OData 서비스를 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-112">If write access is desired, or if a local WCF Data Service is desired, you can follow the steps of the [WCF Data Services Quickstart](../data/wcf/quickstart-wcf-data-services.md) to create a local OData service that provides access to the Northwind database.</span></span> <span data-ttu-id="3d2d3-113">퀵 스타트를 따르는 경우 이 항목의 예제 코드에 제공된 URI를 로컬 URI로 바꿉니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-113">If you follow the quickstart, substitute the local URI for the one provided in the example code in this topic.</span></span>

## <a name="consuming-an-odata-feed-using-the-client-libraries"></a><span data-ttu-id="3d2d3-114">클라이언트 라이브러리를 사용 하 여 OData 피드 사용</span><span class="sxs-lookup"><span data-stu-id="3d2d3-114">Consuming an OData feed using the client libraries</span></span>

<span data-ttu-id="3d2d3-115">WCF Data Services에는 .NET Framework 및 클라이언트 응용 프로그램에서 OData 피드를 보다 쉽게 사용할 수 있도록 하는 클라이언트 라이브러리가 포함 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-115">WCF Data Services includes client libraries that enable you to more easily consume an OData feed from .NET Framework and client applications.</span></span> <span data-ttu-id="3d2d3-116">이러한 라이브러리는 HTTP 메시지를 보내고 받는 작업을 단순화합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-116">These libraries simplify sending and receiving HTTP messages.</span></span> <span data-ttu-id="3d2d3-117">또한 엔터티 데이터를 나타내는 CLR 개체로 메시지 페이로드를 변환합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-117">They also translate the message payload into CLR objects that represent entity data.</span></span> <span data-ttu-id="3d2d3-118">클라이언트 라이브러리는 두 가지 핵심 클래스인 <xref:System.Data.Services.Client.DataServiceContext> 및 <xref:System.Data.Services.Client.DataServiceQuery%601>를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-118">The client libraries feature the two core classes <xref:System.Data.Services.Client.DataServiceContext> and <xref:System.Data.Services.Client.DataServiceQuery%601>.</span></span> <span data-ttu-id="3d2d3-119">이러한 클래스를 사용하면 데이터 서비스를 쿼리한 다음 반환된 엔터티 데이터를 CLR 개체로 사용하여 작업할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-119">These classes enable you to query a data service and then work with the returned entity data as CLR objects.</span></span> <span data-ttu-id="3d2d3-120">이 단원에서는 클라이언트 라이브러리를 사용하는 활동을 만드는 두 가지 방법에 대해 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-120">This section covers two approaches to creating activities that use the client libraries.</span></span>

### <a name="adding-a-service-reference-to-the-wcf-data-service"></a><span data-ttu-id="3d2d3-121">WCF 데이터 서비스에 대 한 서비스 참조 추가</span><span class="sxs-lookup"><span data-stu-id="3d2d3-121">Adding a service reference to the WCF Data service</span></span>

<span data-ttu-id="3d2d3-122">Northwind 클라이언트 라이브러리를 생성 하려면 Visual Studio 2012의 **서비스 참조 추가** 대화 상자를 사용 하 여 northwind OData 서비스에 대 한 참조를 추가할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-122">To generate the Northwind client libraries, you can use the **Add Service Reference** dialog box in Visual Studio 2012 to add a reference to the Northwind OData service.</span></span>

![서비스 참조 추가 대화 상자를 보여 주는 스크린샷](./media/consuming-odata-feeds-from-a-workflow/add-service-reference-dialog.gif)

<span data-ttu-id="3d2d3-124">서비스에서 노출하는 서비스 작업이 없으며 **서비스** 목록에 Northwind 데이터 서비스에서 노출하는 엔터티를 나타내는 항목이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-124">Note that there are no service operations exposed by the service, and in the **Services** list there are items representing the entities exposed by the Northwind data service.</span></span> <span data-ttu-id="3d2d3-125">서비스 참조가 추가되면 이러한 엔터티에 대한 클래스가 생성되며 클라이언트 코드에서 사용될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-125">When the service reference is added, classes will be generated for these entities and they can be used in the client code.</span></span> <span data-ttu-id="3d2d3-126">이 항목의 예제에서는 이러한 클래스와 `NorthwindEntities` 클래스를 사용하여 쿼리를 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-126">The examples in this topic use these classes and the `NorthwindEntities` class to perform the queries.</span></span>

> [!NOTE]
> <span data-ttu-id="3d2d3-127">자세한 내용은 [데이터 서비스 클라이언트 라이브러리 생성 (WCF Data Services)](../data/wcf/generating-the-data-service-client-library-wcf-data-services.md)을 참조 하십시오.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-127">For more information, see [Generating the Data Service Client Library (WCF Data Services)](../data/wcf/generating-the-data-service-client-library-wcf-data-services.md).</span></span>

### <a name="using-asynchronous-methods"></a><span data-ttu-id="3d2d3-128">비동기 메서드 사용</span><span class="sxs-lookup"><span data-stu-id="3d2d3-128">Using asynchronous methods</span></span>

<span data-ttu-id="3d2d3-129">웹을 통해 리소스에 액세스할 때 발생할 수 있는 지연 문제를 해결하려면 WCF Data Services에 비동기적으로 액세스하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-129">To address possible latency issues that may occur when accessing resources over the Web, we recommend accessing WCF Data Services asynchronously.</span></span> <span data-ttu-id="3d2d3-130">WCF Data Services 클라이언트 라이브러리에는 쿼리를 호출 하는 비동기 메서드가 포함 되어 있으며 WF (Windows Workflow Foundation)는 <xref:System.Activities.AsyncCodeActivity> 비동기 작업을 작성 하기 위한 클래스를 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-130">The WCF Data Services client libraries include asynchronous methods for invoking queries, and Windows Workflow Foundation (WF) provides the <xref:System.Activities.AsyncCodeActivity> class for authoring asynchronous activities.</span></span> <span data-ttu-id="3d2d3-131"><xref:System.Activities.AsyncCodeActivity> 파생 작업은 비동기 메서드를 포함 하는 .NET Framework 클래스를 활용 하기 위해 작성 하거나 비동기적으로 실행 되는 코드를 메서드에 추가 하 고 대리자를 사용 하 여 호출할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-131"><xref:System.Activities.AsyncCodeActivity> derived activities can be written to take advantage of .NET Framework classes that have asynchronous methods, or the code to be executed asynchronously can be put into a method and invoked by using a delegate.</span></span> <span data-ttu-id="3d2d3-132">이 단원에서는 <xref:System.Activities.AsyncCodeActivity> 파생 활동의 두 가지 예제를 제공합니다. 한 예제에서는 WCF Data Services 클라이언트 라이브러리의 비동기 메서드를 사용하고 다른 예제에서는 대리자를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-132">This section provides two examples of an <xref:System.Activities.AsyncCodeActivity> derived activity; one that uses the asynchronous methods of the WCF Data Services client libraries and one that uses a delegate.</span></span>

> [!NOTE]
> <span data-ttu-id="3d2d3-133">자세한 내용은 [비동기 작업 (WCF Data Services)](../data/wcf/asynchronous-operations-wcf-data-services.md) 및 [비동기 작업 만들기](creating-asynchronous-activities-in-wf.md)를 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-133">For more information, see [Asynchronous Operations (WCF Data Services)](../data/wcf/asynchronous-operations-wcf-data-services.md) and [Creating Asynchronous Activities](creating-asynchronous-activities-in-wf.md).</span></span>

### <a name="using-client-library-asynchronous-methods"></a><span data-ttu-id="3d2d3-134">클라이언트 라이브러리 비동기 메서드 사용</span><span class="sxs-lookup"><span data-stu-id="3d2d3-134">Using client library asynchronous methods</span></span>

<span data-ttu-id="3d2d3-135"><xref:System.Data.Services.Client.DataServiceQuery%601> 클래스는 OData 서비스를 비동기적으로 쿼리하기 위한 <xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A> 및 <xref:System.Data.Services.Client.DataServiceQuery%601.EndExecute%2A> 메서드를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-135">The <xref:System.Data.Services.Client.DataServiceQuery%601> class provides <xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A> and <xref:System.Data.Services.Client.DataServiceQuery%601.EndExecute%2A> methods for querying an OData service asynchronously.</span></span> <span data-ttu-id="3d2d3-136">이러한 메서드는 <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> 파생 클래스의 <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> 및 <xref:System.Activities.AsyncCodeActivity> 재정의에서 호출할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-136">These methods can be called from the <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> and <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> overrides of an <xref:System.Activities.AsyncCodeActivity> derived class.</span></span> <span data-ttu-id="3d2d3-137"><xref:System.Activities.AsyncCodeActivity> <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> 재정의가 반환 되 면 워크플로가 유휴 상태가 될 수 있으며 (지속 되지 않음), 비동기 작업이 완료 되 면 <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> 가 런타임에 의해 호출 됩니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-137">When the <xref:System.Activities.AsyncCodeActivity> <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> override returns, the workflow can go idle (but not persist), and when the asynchronous work is completed, <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> is invoked by the runtime.</span></span>

<span data-ttu-id="3d2d3-138">다음 예제에서는 두 입력 인수를 가진 `OrdersByCustomer` 활동을 정의합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-138">In the following example, an `OrdersByCustomer` activity is defined that has two input arguments.</span></span> <span data-ttu-id="3d2d3-139">`CustomerId` 인수는 반환할 주문을 식별하는 고객을 나타내고, `ServiceUri` 인수는 쿼리할 OData 서비스의 URI를 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-139">The `CustomerId` argument represents the customer who identifies which orders to return, and the `ServiceUri` argument represents the URI of the OData service to be queried.</span></span> <span data-ttu-id="3d2d3-140">활동이 `AsyncCodeActivity<IEnumerable<Order>>` 에서 파생되기 때문에 쿼리의 결과를 반환하는 데 사용되는 <xref:System.Activities.Activity%601.Result%2A> 출력 인수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-140">Because the activity derives from `AsyncCodeActivity<IEnumerable<Order>>` there is also a <xref:System.Activities.Activity%601.Result%2A> output argument that is used to return the results of the query.</span></span> <span data-ttu-id="3d2d3-141"><xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> 재정의는 지정된 고객의 모든 주문을 선택하는 LINQ 쿼리를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-141">The <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> override creates a LINQ query that selects all orders of the specified customer.</span></span> <span data-ttu-id="3d2d3-142">이 쿼리는 전달된 <xref:System.Activities.AsyncCodeActivityContext.UserState%2A> 의 <xref:System.Activities.AsyncCodeActivityContext>로 지정되며, 그런 다음 쿼리의 <xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A> 메서드가 호출됩니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-142">This query is specified as the <xref:System.Activities.AsyncCodeActivityContext.UserState%2A> of the passed <xref:System.Activities.AsyncCodeActivityContext>, and then the query's <xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A> method is called.</span></span> <span data-ttu-id="3d2d3-143">쿼리의 <xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A> 로 전달된 콜백과 상태는 활동의 <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> 메서드에 전달되는 콜백과 상태입니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-143">Note that the callback and state that are passed into the query's <xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A> are the ones that are passed in to the activity's <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> method.</span></span> <span data-ttu-id="3d2d3-144">쿼리 실행이 완료되면 활동의 <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> 메서드가 호출됩니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-144">When the query has finished executing, the activity's <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> method is invoked.</span></span> <span data-ttu-id="3d2d3-145">쿼리는 <xref:System.Activities.AsyncCodeActivityContext.UserState%2A>에서 검색되며, 그런 다음 쿼리의 <xref:System.Data.Services.Client.DataServiceQuery%601.EndExecute%2A> 메서드가 호출됩니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-145">The query is retrieved from the <xref:System.Activities.AsyncCodeActivityContext.UserState%2A>, and then the query's <xref:System.Data.Services.Client.DataServiceQuery%601.EndExecute%2A> method is called.</span></span> <span data-ttu-id="3d2d3-146">이 메서드는 지정된 엔터티 형식의 <xref:System.Collections.Generic.IEnumerable%601> 을 반환합니다. 이 경우에는 `Order`를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-146">This method returns an <xref:System.Collections.Generic.IEnumerable%601> of the specified entity type; in this case `Order`.</span></span> <span data-ttu-id="3d2d3-147">`IEnumerable<Order>`는의 제네릭 형식 이므로 <xref:System.Activities.AsyncCodeActivity%601> <xref:System.Collections.IEnumerable> <xref:System.Activities.Activity%601.Result%2A> <xref:System.Activities.OutArgument%601> 활동의로 설정 됩니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-147">Since `IEnumerable<Order>` is the generic type of the <xref:System.Activities.AsyncCodeActivity%601>, this <xref:System.Collections.IEnumerable> is set as the <xref:System.Activities.Activity%601.Result%2A> <xref:System.Activities.OutArgument%601> of the activity.</span></span>

[!code-csharp[CFX_WCFDataServicesActivityExample#100](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_WCFDataServicesActivityExample/cs/Program.cs#100)]

<span data-ttu-id="3d2d3-148">다음 예제에서는 `OrdersByCustomer` 활동이 지정된 고객의 주문 목록을 검색한 다음 <xref:System.Activities.Statements.ForEach%601> 활동이 반환된 주문을 열거하고 각 주문의 날짜를 콘솔에 기록합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-148">In the following example, the `OrdersByCustomer` activity retrieves a list of orders for the specified customer, and then a <xref:System.Activities.Statements.ForEach%601> activity enumerates the returned orders and writes the date of each order to the console.</span></span>

[!code-csharp[CFX_WCFDataServicesActivityExample#10](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_WCFDataServicesActivityExample/cs/Program.cs#10)]

<span data-ttu-id="3d2d3-149">이 워크플로가 호출되면 다음 데이터가 콘솔에 기록됩니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-149">When this workflow is invoked, the following data is written to the console:</span></span>

```console
Calling WCF Data Service...
8/25/1997
10/3/1997
10/13/1997
1/15/1998
3/16/1998
4/9/1998
```

> [!NOTE]
> <span data-ttu-id="3d2d3-150">OData 서버에 연결할 수 없는 경우 다음 예외와 유사한 예외가 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-150">If a connection to the OData server cannot be established, you will get an exception similar to the following exception:</span></span>
>
> <span data-ttu-id="3d2d3-151">처리되지 않은 예외: System.InvalidOperationException: 이 요청을 처리하는 동안 오류가 발생했습니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-151">Unhandled Exception: System.InvalidOperationException: An error occurred while processing this request.</span></span> <span data-ttu-id="3d2d3-152">---> System.Net.WebException: 원격 서버에 연결할 수 없습니다. ---> System.Net.Sockets.SocketException: 연결된 구성원으로부터 응답이 없어 연결하지 못했거나, 호스트로부터 응답이 없어 연결이 끊어졌습니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-152">---> System.Net.WebException: Unable to connect to the remote server ---> System.Net.Sockets.SocketException: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond.</span></span>

<span data-ttu-id="3d2d3-153">쿼리에서 반환된 데이터를 추가로 처리해야 하는 경우 활동의 <xref:System.Activities.AsyncCodeActivity%601.EndExecute%2A> 재정의에서 이를 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-153">If any additional processing of the data returned by the query is required, it can be done in the activity's <xref:System.Activities.AsyncCodeActivity%601.EndExecute%2A> override.</span></span> <span data-ttu-id="3d2d3-154"><xref:System.Activities.AsyncCodeActivity%601.BeginExecute%2A> 및 <xref:System.Activities.AsyncCodeActivity%601.EndExecute%2A> 는 워크플로 스레드를 사용하여 호출되며 이러한 재정의의 모든 코드는 비동기적으로 실행되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-154">Both <xref:System.Activities.AsyncCodeActivity%601.BeginExecute%2A> and <xref:System.Activities.AsyncCodeActivity%601.EndExecute%2A> are invoked by using the workflow thread, and any code in these overrides does not run asynchronously.</span></span> <span data-ttu-id="3d2d3-155">추가 처리가 광범위하거나 오래 실행되는 경우나 쿼리 결과가 페이징되는 경우 다음 단원에서 설명하는 방법을 고려해야 합니다. 이 방법에서는 대리자를 사용하여 쿼리를 실행하고 비동기적으로 추가 처리를 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-155">If the additional processing is extensive or long-running, or the query results are paged, you should consider the approach discussed in the next section, which uses a delegate to execute the query and perform additional processing asynchronously.</span></span>

### <a name="using-a-delegate"></a><span data-ttu-id="3d2d3-156">대리자 사용</span><span class="sxs-lookup"><span data-stu-id="3d2d3-156">Using a delegate</span></span>

<span data-ttu-id="3d2d3-157">기반 활동은 .NET Framework 클래스의 비동기 메서드를 호출 하는 것 외에 <xref:System.Activities.AsyncCodeActivity> 도 해당 메서드 중 하나에서 비동기 논리를 정의할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-157">In addition to invoking the asynchronous method of a .NET Framework class, an <xref:System.Activities.AsyncCodeActivity>-based activity can also define the asynchronous logic in one of its methods.</span></span> <span data-ttu-id="3d2d3-158">이 메서드는 활동의 <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> 재정의에서 대리자를 사용하여 지정됩니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-158">This method is specified by using a delegate in the activity's <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> override.</span></span> <span data-ttu-id="3d2d3-159">메서드가 반환될 때 런타임에서 활동의 <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> 재정의를 호출합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-159">When the method returns, the runtime invokes the activity's <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> override.</span></span> <span data-ttu-id="3d2d3-160">워크플로에서 OData 서비스를 호출할 때 이 메서드를 사용하여 서비스를 쿼리하고 추가 처리를 제공할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-160">When calling an OData service from a workflow, this method can be used to query the service and provide any additional processing.</span></span>

<span data-ttu-id="3d2d3-161">다음 예제에서는 `ListCustomers` 활동을 정의합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-161">In the following example, a `ListCustomers` activity is defined.</span></span> <span data-ttu-id="3d2d3-162">이 활동은 샘플 Northwind 데이터 서비스를 쿼리하고 Northwind 데이터베이스의 모든 고객이 포함된 `List<Customer>` 를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-162">This activity queries the sample Northwind data service and returns a `List<Customer>` that contains all of the customers in the Northwind database.</span></span> <span data-ttu-id="3d2d3-163">비동기 작업은 `GetCustomers` 메서드에서 수행됩니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-163">The asynchronous work is performed by the `GetCustomers` method.</span></span> <span data-ttu-id="3d2d3-164">이 메서드는 서비스에서 모든 고객을 쿼리하여 `List<Customer>`에 복사합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-164">This method queries the service for all customers, and then copies them into a `List<Customer>`.</span></span> <span data-ttu-id="3d2d3-165">그런 다음 결과가 페이징되는지 확인하고</span><span class="sxs-lookup"><span data-stu-id="3d2d3-165">It then checks to see if the results are paged.</span></span> <span data-ttu-id="3d2d3-166">페이징되면 서비스에서 결과의 다음 페이지를 쿼리하여 목록에 추가하고 모든 고객 데이터가 검색될 때까지 계속합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-166">If so, it queries the service for the next page of results, adds them to the list, and continues until all of the customer data has been retrieved.</span></span>

> [!NOTE]
> <span data-ttu-id="3d2d3-167">WCF Data Services에서 페이징 하는 방법에 대 한 자세한 내용은 [방법: 페이지 단위 결과 로드 (WCF Data Services)](../data/wcf/how-to-load-paged-results-wcf-data-services.md)를 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-167">For more information about paging in WCF Data Services, see [How to: Load Paged Results (WCF Data Services)](../data/wcf/how-to-load-paged-results-wcf-data-services.md).</span></span>

<span data-ttu-id="3d2d3-168">모든 고객이 추가되면 목록이 반환됩니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-168">Once all customers are added, the list is returned.</span></span> <span data-ttu-id="3d2d3-169">`GetCustomers` 메서드는 활동의 <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> 재정의에 지정됩니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-169">The `GetCustomers` method is specified in the activity's <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> override.</span></span> <span data-ttu-id="3d2d3-170">메서드에 반환 값이 있으므로 `Func<string, List<Customer>>` 가 메서드를 지정하기 위해 만들어집니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-170">Since the method has a return value, a `Func<string, List<Customer>>` is created to specify the method.</span></span>

> [!NOTE]
> <span data-ttu-id="3d2d3-171">비동기 작업을 수행하는 메서드에 반환 값이 없는 경우 <xref:System.Action> 대신 <xref:System.Func%601>이 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-171">If the method that performs the asynchronous work does not have a return value, an <xref:System.Action> is used instead of a <xref:System.Func%601>.</span></span> <span data-ttu-id="3d2d3-172">두 방법을 사용 하 여 비동기 예제를 만드는 예제는 [비동기 작업 만들기](creating-asynchronous-activities-in-wf.md)를 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-172">For examples of creating an asynchronous example using both approaches, see [Creating Asynchronous Activities](creating-asynchronous-activities-in-wf.md).</span></span>

<span data-ttu-id="3d2d3-173">이 <xref:System.Func%601>가 <xref:System.Activities.AsyncCodeActivityContext.UserState%2A>에 할당된 다음 `BeginInvoke`가 호출됩니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-173">This <xref:System.Func%601> is assigned to the <xref:System.Activities.AsyncCodeActivityContext.UserState%2A>, and then `BeginInvoke` is called.</span></span> <span data-ttu-id="3d2d3-174">호출될 메서드가 활동의 인수 환경에 액세스할 수 없으므로 `ServiceUri` 인수의 값이 <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A>에 전달된 콜백 및 상태와 함께 첫 번째 매개 변수로 전달됩니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-174">Since the method to be invoked does not have access to the activity's environment of arguments, the value of the `ServiceUri` argument is passed as the first parameter, together with the callback and state that were passed into <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A>.</span></span> <span data-ttu-id="3d2d3-175">`GetCustomers` 가 반환되면 런타임에서 <xref:System.Activities.AsyncCodeActivity.EndExecute%2A>를 호출합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-175">When `GetCustomers` returns, the runtime invokes <xref:System.Activities.AsyncCodeActivity.EndExecute%2A>.</span></span> <span data-ttu-id="3d2d3-176"><xref:System.Activities.AsyncCodeActivity.EndExecute%2A> 의 코드에서는 <xref:System.Activities.AsyncCodeActivityContext.UserState%2A>에서 대리자를 검색하고 `EndInvoke`를 호출하며 `GetCustomers` 메서드에서 반환된 고객의 목록인 결과를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-176">The code in <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> retrieves the delegate from the <xref:System.Activities.AsyncCodeActivityContext.UserState%2A>, calls `EndInvoke`, and returns the result, which is the list of customers returned from the `GetCustomers` method.</span></span>

[!code-csharp[CFX_WCFDataServicesActivityExample#200](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_WCFDataServicesActivityExample/cs/Program.cs#200)]

<span data-ttu-id="3d2d3-177">다음 예제에서는 `ListCustomers` 활동이 고객의 목록을 검색한 다음 <xref:System.Activities.Statements.ForEach%601> 활동이 고객을 열거하고 각 고객의 회사 이름과 연락처 이름을 콘솔에 기록합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-177">In the following example, the `ListCustomers` activity retrieves a list of customers, and then a <xref:System.Activities.Statements.ForEach%601> activity enumerates them and writes the company name and contact name of each customer to the console.</span></span>

[!code-csharp[CFX_WCFDataServicesActivityExample#20](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_WCFDataServicesActivityExample/cs/Program.cs#20)]

<span data-ttu-id="3d2d3-178">이 워크플로가 호출되면 다음 데이터가 콘솔에 기록됩니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-178">When this workflow is invoked, the following data is written to the console.</span></span> <span data-ttu-id="3d2d3-179">이 쿼리가 많은 고객을 반환하므로 여기에서는 출력의 일부만 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-179">Since this query returns many customers, only part of the output is displayed here.</span></span>

```console
Calling WCF Data Service...
Alfreds Futterkiste, Contact: Maria Anders
Ana Trujillo Emparedados y helados, Contact: Ana Trujillo
Antonio Moreno Taquería, Contact: Antonio Moreno
Around the Horn, Contact: Thomas Hardy
Berglunds snabbköp, Contact: Christina Berglund
...
```

## <a name="consuming-an-odata-feed-without-using-the-client-libraries"></a><span data-ttu-id="3d2d3-180">클라이언트 라이브러리를 사용 하지 않고 OData 피드 사용</span><span class="sxs-lookup"><span data-stu-id="3d2d3-180">Consuming an OData feed without using the client libraries</span></span>

<span data-ttu-id="3d2d3-181">OData는 URI로 주소를 지정할 수 있는 리소스로 데이터를 노출합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-181">OData exposes data as resources that are addressable by URIs.</span></span> <span data-ttu-id="3d2d3-182">클라이언트 라이브러리를 사용할 때 이러한 URI가 자동으로 만들어지지만 클라이언트 라이브러리를 반드시 사용할 필요는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-182">When you use the client libraries these URIs are created for you, but you do not have to use the client libraries.</span></span> <span data-ttu-id="3d2d3-183">적절한 경우 클라이언트 라이브러리를 사용하지 않고 OData 서비스에 직접 액세스할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-183">If desired, OData services can be accessed directly without using the client libraries.</span></span> <span data-ttu-id="3d2d3-184">클라이언트 라이브러리를 사용하지 않는 경우 서비스의 위치와 원하는 데이터는 URI로 지정되며 결과가 HTTP 요청의 응답으로 반환됩니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-184">When not using the client libraries the location of the service and the desired data are specified by the URI and the results are returned in the response to the HTTP request.</span></span> <span data-ttu-id="3d2d3-185">그러면 이 원시 데이터를 원하는 방식으로 처리하거나 조작할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-185">This raw data can then be processed or manipulated in the desired manner.</span></span> <span data-ttu-id="3d2d3-186">OData 쿼리의 결과를 검색하는 한 가지 방법은 <xref:System.Net.WebClient> 클래스를 사용하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-186">One way to retrieve the results of an OData query is by using the <xref:System.Net.WebClient> class.</span></span> <span data-ttu-id="3d2d3-187">이 예제에서는 ALFKI 키로 표현된 고객의 연락처 이름이 검색됩니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-187">In this example, the contact name for the customer represented by the key ALFKI is retrieved.</span></span>

[!code-csharp[CFX_WCFDataServicesActivityExample#2](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_WCFDataServicesActivityExample/cs/Program.cs#2)]

<span data-ttu-id="3d2d3-188">이 코드가 실행되면 다음 출력이 콘솔에 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-188">When this code is run, the following output is displayed to the console:</span></span>

```console
Raw data returned:
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<ContactName xmlns="http://schemas.microsoft.com/ado/2007/08/dataservices">Maria Anders</ContactName>
```

<span data-ttu-id="3d2d3-189">워크플로에서 이 예제의 코드는 <xref:System.Activities.CodeActivity.Execute%2A> 기반 사용자 지정 활동의 <xref:System.Activities.CodeActivity> 재정의에 통합될 수 있지만, <xref:System.Activities.Expressions.InvokeMethod%601> 활동을 사용하여 동일한 기능을 수행할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-189">In a workflow, the code from this example could be incorporated into the <xref:System.Activities.CodeActivity.Execute%2A> override of a <xref:System.Activities.CodeActivity>-based custom activity, but the same functionality can also be accomplished by using the <xref:System.Activities.Expressions.InvokeMethod%601> activity.</span></span> <span data-ttu-id="3d2d3-190">워크플로 작성자는 <xref:System.Activities.Expressions.InvokeMethod%601> 활동을 사용하여 클래스의 정적 메서드와 인스턴스 메서드를 호출할 수 있습니다. 이 활동에는 지정된 메서드를 비동기적으로 호출하는 옵션도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-190">The <xref:System.Activities.Expressions.InvokeMethod%601> activity enables workflow authors to invoke static and instance methods of a class, and also has an option to invoke the specified method asynchronously.</span></span> <span data-ttu-id="3d2d3-191">다음 예제에서는 <xref:System.Activities.Expressions.InvokeMethod%601> 활동이 <xref:System.Net.WebClient.DownloadString%2A> 클래스의 <xref:System.Net.WebClient> 메서드를 호출하도록 구성되며 고객의 목록을 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-191">In the following example, an <xref:System.Activities.Expressions.InvokeMethod%601> activity is configured to call the <xref:System.Net.WebClient.DownloadString%2A> method of the <xref:System.Net.WebClient> class and return a list of customers.</span></span>

[!code-csharp[CFX_WCFDataServicesActivityExample#3](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_WCFDataServicesActivityExample/cs/Program.cs#3)]

<span data-ttu-id="3d2d3-192"><xref:System.Activities.Expressions.InvokeMethod%601> 는 클래스의 정적 메서드와 인스턴스 메서드를 모두 호출할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-192"><xref:System.Activities.Expressions.InvokeMethod%601> can call both static and instance methods of a class.</span></span> <span data-ttu-id="3d2d3-193"><xref:System.Net.WebClient.DownloadString%2A> 은 <xref:System.Net.WebClient> 클래스의 인스턴스 메서드이므로 <xref:System.Net.WebClient> 클래스의 새 인스턴스가 <xref:System.Activities.Expressions.InvokeMethod%601.TargetObject%2A>에 대해 지정됩니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-193">Since <xref:System.Net.WebClient.DownloadString%2A> is an instance method of the <xref:System.Net.WebClient> class, a new instance of the <xref:System.Net.WebClient> class is specified for the <xref:System.Activities.Expressions.InvokeMethod%601.TargetObject%2A>.</span></span> <span data-ttu-id="3d2d3-194">`DownloadString` 은 <xref:System.Activities.Expressions.InvokeMethod%601.MethodName%2A>으로 지정되고, 쿼리가 포함된 URI는 <xref:System.Activities.Expressions.InvokeMethod%601.Parameters%2A> 컬렉션에 지정되고, 반환 값은 <xref:System.Activities.Activity%601.Result%2A> 값에 할당됩니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-194">`DownloadString` is specified as the <xref:System.Activities.Expressions.InvokeMethod%601.MethodName%2A>, the URI that contains the query is specified in the <xref:System.Activities.Expressions.InvokeMethod%601.Parameters%2A> collection, and the return value is assigned to the <xref:System.Activities.Activity%601.Result%2A> value.</span></span> <span data-ttu-id="3d2d3-195"><xref:System.Activities.Expressions.InvokeMethod%601.RunAsynchronously%2A> 값은 메서드 호출이 워크플로와 관련하여 비동기적으로 실행됨을 의미하는 `true`로 설정됩니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-195">The <xref:System.Activities.Expressions.InvokeMethod%601.RunAsynchronously%2A> value is set to `true`, which means that the method invocation will run asynchronously with regard to the workflow.</span></span> <span data-ttu-id="3d2d3-196">다음 예제에서는 <xref:System.Activities.Expressions.InvokeMethod%601> 활동을 사용하여 샘플 Northwind 데이터 서비스에서 특정 고객의 주문 목록을 쿼리하는 워크플로가 생성되며 반환된 데이터가 콘솔에 기록됩니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-196">In the following example, a workflow is constructed that uses the <xref:System.Activities.Expressions.InvokeMethod%601> activity to query the sample Northwind data service for a list of orders for a specific customer, and then the returned data is written to the console.</span></span>

[!code-csharp[CFX_WCFDataServicesActivityExample#1](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_WCFDataServicesActivityExample/cs/Program.cs#1)]

<span data-ttu-id="3d2d3-197">이 워크플로가 호출되면 다음 출력이 콘솔에 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-197">When this workflow is invoked, the following output is displayed to the console.</span></span> <span data-ttu-id="3d2d3-198">이 쿼리가 몇 가지 주문을 반환하므로 여기에서는 출력의 일부만 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-198">Since this query returns several orders, only part of the output is displayed here.</span></span>

```console
Calling WCF Data Service...
Raw data returned:

<?xml version="1.0" encoding="utf-8" standalone="yes"?>*
<feed
xml:base="http://services.odata.org/Northwind/Northwind.svc/"
xmlns:d="http://schemas.microsoft.com/ado/2007/08/dataservices"
xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata"
xmlns="http://www.w3.org/2005/Atom">
<title type="text">Orders\</title>
<id>http://services.odata.org/Northwind/Northwind.svc/Customers('ALFKI')/Orders\</id>
<updated>2010-05-19T19:37:07Z\</updated>
<link rel="self" title="Orders" href="Orders" />
<entry>
<id>http://services.odata.org/Northwind/Northwind.svc/Orders(10643)\</id>
<title type="text">\</title>
<updated>2010-05-19T19:37:07Z\</updated>
<author>
<name />
</author>
<link rel="edit" title="Order" href="Orders(10643)" />
<link rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/Customer" type="application/atom+xml;type=entry" title="Customer" href="Orders(10643)/Customer" />
...
```

<span data-ttu-id="3d2d3-199">이 예제에서는 워크플로 애플리케이션 작성자가 OData 서비스에서 반환된 원시 데이터를 사용하는 데 사용할 수 있는 한 가지 방법을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-199">This example provides one method that workflow application authors can use to consume the raw data returned from an OData service.</span></span> <span data-ttu-id="3d2d3-200">Uri를 사용 하 여 WCF Data Services 액세스 하는 방법에 대 한 자세한 내용은 [데이터 서비스 리소스에 액세스 (WCF Data Services)](../data/wcf/accessing-data-service-resources-wcf-data-services.md) 및 [OData: URI 규칙](https://www.odata.org/documentation/odata-version-2-0/uri-conventions/)을 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="3d2d3-200">For more information about accessing WCF Data Services using URIs, see [Accessing Data Service Resources (WCF Data Services)](../data/wcf/accessing-data-service-resources-wcf-data-services.md) and [OData: URI Conventions](https://www.odata.org/documentation/odata-version-2-0/uri-conventions/).</span></span>
