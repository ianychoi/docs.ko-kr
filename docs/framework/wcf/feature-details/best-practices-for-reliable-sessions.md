---
description: '자세한 정보: 신뢰할 수 있는 세션에 대 한 모범 사례'
title: 신뢰할 수 있는 세션을 위한 최선의 방법
ms.date: 03/30/2017
ms.assetid: b94f6e01-8070-40b6-aac7-a2cb7b4cb4f2
ms.openlocfilehash: 4b05dd914d2c5b8ec7941417b727bec1e5b43ba4
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 02/06/2021
ms.locfileid: "99643672"
---
# <a name="best-practices-for-reliable-sessions"></a><span data-ttu-id="b0bcb-103">신뢰할 수 있는 세션을 위한 최선의 방법</span><span class="sxs-lookup"><span data-stu-id="b0bcb-103">Best Practices for Reliable Sessions</span></span>

<span data-ttu-id="b0bcb-104">이 항목에서는 신뢰할 수 있는 세션에 대 한 모범 사례를 설명 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-104">This topic discusses best practices for reliable sessions.</span></span>

## <a name="setting-maxtransferwindowsize"></a><span data-ttu-id="b0bcb-105">MaxTransferWindowSize 설정</span><span class="sxs-lookup"><span data-stu-id="b0bcb-105">Setting MaxTransferWindowSize</span></span>

<span data-ttu-id="b0bcb-106">WCF (Windows Communication Foundation)의 신뢰할 수 있는 세션은 전송 창을 사용 하 여 클라이언트 및 서비스에서 메시지를 보관 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-106">Reliable sessions in Windows Communication Foundation (WCF) use a transfer window to hold messages on the client and service.</span></span> <span data-ttu-id="b0bcb-107">구성 가능한 속성 <xref:System.ServiceModel.Channels.ReliableSessionBindingElement.MaxTransferWindowSize%2A>는 전송 창이 보관할 수 있는 메시지 수를 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-107">The configurable property <xref:System.ServiceModel.Channels.ReliableSessionBindingElement.MaxTransferWindowSize%2A> indicates how many messages the transfer window can hold.</span></span>

<span data-ttu-id="b0bcb-108">보낸 사람에서이는 전송 창이 승인을 기다리는 동안 보관할 수 있는 메시지 수를 나타냅니다. 수신기에서 서비스에 대해 버퍼링 할 메시지 수를 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-108">On the sender, this indicates how many messages the transfer window can hold while waiting for acknowledgements; on the receiver, it indicates how many messages to buffer for the service.</span></span>

<span data-ttu-id="b0bcb-109">적절 한 크기를 선택 하면 네트워크의 효율성과 서비스의 최적 용량에 영향을 줍니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-109">Choosing the right size impacts the efficiency of the network and the optimal capacity of the service.</span></span> <span data-ttu-id="b0bcb-110">다음 섹션에서는이 속성의 값과 값의 영향을 선택할 때 고려해 야 할 사항에 대해 자세히 설명 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-110">The following sections detail what to consider when choosing a value for this property and the impact of the value.</span></span>

<span data-ttu-id="b0bcb-111">기본 전송 창 크기는 8 개 메시지입니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-111">The default transfer window size is eight messages.</span></span>

### <a name="efficient-use-of-the-network"></a><span data-ttu-id="b0bcb-112">네트워크의 효율적인 사용</span><span class="sxs-lookup"><span data-stu-id="b0bcb-112">Efficient use of the network</span></span>

<span data-ttu-id="b0bcb-113">이 컨텍스트에서 *네트워크* 라는 용어는 클라이언트 (발신자)와 서비스 (수신자) 간의 통신 기반으로 사용 되는 모든 항목에 해당 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-113">In this context, the term *network* corresponds to everything used as the basis of communication between a client (sender) and a service (receiver).</span></span> <span data-ttu-id="b0bcb-114">여기에는 SOAP 라우터 또는 HTTP 프록시/방화벽을 포함 하 여 간의 전송 연결 및 중간 또는 브리지가 포함 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-114">This includes the transport connections and any intermediary or bridges in between, including SOAP routers or HTTP proxies/firewalls.</span></span>

<span data-ttu-id="b0bcb-115">네트워크를 효율적으로 사용하려면 네트워크 용량을 최대한 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-115">Efficient use of the network ensures that network capacity is fully used.</span></span> <span data-ttu-id="b0bcb-116">네트워크를 통해 초당 전송할 수 있는 데이터 양 (*데이터 요금*) 및 발신자에서 받는 사람으로 데이터를 전송 하는 데 걸리는 시간 (*대기 시간*)은 네트워크를 효과적으로 활용 하는 방식에 영향을 줍니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-116">Both the amount of data that can be transferred per second over the network (*data rate*) and the time it takes to transfer data from the sender to the receiver (*latency*) impact how effectively the network is utilized.</span></span>

<span data-ttu-id="b0bcb-117">발신자의 경우 <xref:System.ServiceModel.Channels.ReliableSessionBindingElement.MaxTransferWindowSize%2A> 속성은 전송 창이 승인을 기다리는 동안 보관할 수 있는 메시지 수를 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-117">On the sender, the property <xref:System.ServiceModel.Channels.ReliableSessionBindingElement.MaxTransferWindowSize%2A> indicates how many messages its transfer window can hold while waiting for acknowledgements.</span></span> <span data-ttu-id="b0bcb-118">네트워크 대기 시간이 높고 응답성이 뛰어나고 효과적인 네트워크 사용률을 보장 하기 위해 전송 창 크기를 늘려야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-118">If the network latency is high and in order to ensure a responsive sender and effective network utilization, you should increase the transfer window size.</span></span>

<span data-ttu-id="b0bcb-119">예를 들어 발신자가 데이터 속도를 유지 하는 경우에도 발신자와 수신자 사이에 몇 개의 중개자가 있거나 데이터가 손실 된 매개 또는 네트워크를 통해 전달 되어야 하는 경우 대기 시간이 길어질 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-119">For example even if the sender keeps up with data rate, latency could be high if several intermediaries exist between the sender and receiver or the data must pass through a lossy intermediary or network.</span></span> <span data-ttu-id="b0bcb-120">따라서 발신자는 네트워크에서 보낼 새 메시지를 수락 하기 전에 전송 창에서 메시지에 대 한 승인을 기다려야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-120">Thus, the sender has to wait for acknowledgements for the messages in its transfer window before accepting new messages to send on the wire.</span></span> <span data-ttu-id="b0bcb-121">대기 시간이 긴 버퍼가 작을수록 네트워크 사용률은 줄어듭니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-121">The smaller the buffer with high latency, the less effective the network utilization.</span></span> <span data-ttu-id="b0bcb-122">반면, 서비스가 클라이언트에서 보낸 데이터의 최고 속도를 파악 해야 할 수 있으므로 전송 창 크기가 너무 높으면 서비스에 영향을 줄 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-122">On the other hand, too high a transfer window size may impact the service because the service may need to catch up to the high rate of data sent by the client.</span></span>

### <a name="running-the-service-to-capacity"></a><span data-ttu-id="b0bcb-123">용량에 서비스 실행</span><span class="sxs-lookup"><span data-stu-id="b0bcb-123">Running the service to capacity</span></span>

<span data-ttu-id="b0bcb-124">네트워크를 효율적으로 사용 하는 경우에도 최적의 용량에서 서비스를 실행 하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-124">As much as the network is used efficiently, ideally you also want the service to run at optimal capacity.</span></span> <span data-ttu-id="b0bcb-125">수신자의 전송 창 크기 속성은 수신자가 버퍼링할 수 있는 메시지 수를 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-125">The transfer window size property on the receiver indicates how many messages the receiver can buffer.</span></span> <span data-ttu-id="b0bcb-126">이 메시지 버퍼링은 네트워크 흐름 제어에 도움을 줄 뿐만 아니라 서비스를 최대 용량으로 실행할 수 있도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-126">This message buffering helps not only the network flow control but also enables the service to run to full capacity.</span></span> <span data-ttu-id="b0bcb-127">예를 들어 버퍼가 메시지 하나이 고 메시지가 서비스에서 처리할 수 있는 것 보다 빠르게 도착할 경우 네트워크에서 메시지를 삭제 하 고 용량이 낭비 되거나 사용률이 낮은 것일 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-127">For example if the buffer is one message and messages arrive faster than the service can process them, then the network might drop messages and capacity might be wasted or underutilized.</span></span>

<span data-ttu-id="b0bcb-128">버퍼를 사용 하면 이전에 받은 메시지를 처리 하는 동안 동시에 메시지를 받고 버퍼링 하므로 서비스 가용성이 향상 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-128">Using a buffer increases the availability of the service as it concurrently receives and buffers a message while processing the previously received messages.</span></span>

<span data-ttu-id="b0bcb-129">`MaxTransferWindowSize`발신자와 수신자 모두에 대해 동일한를 사용 하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-129">We recommended that you use the same `MaxTransferWindowSize` on both the sender and receiver.</span></span>

### <a name="enabling-flow-control"></a><span data-ttu-id="b0bcb-130">흐름 제어 사용</span><span class="sxs-lookup"><span data-stu-id="b0bcb-130">Enabling flow control</span></span>

<span data-ttu-id="b0bcb-131">*흐름 제어* 는 발신자와 수신자가 서로 속도를 유지 하도록 보장 하는 메커니즘입니다. 즉, 메시지를 사용 하 고 생성 되는 속도에 따라 처리 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-131">*Flow control* is a mechanism that ensures that the sender and receiver keep pace with each other, that is, the messages are consumed and acted upon as fast as they're produced.</span></span> <span data-ttu-id="b0bcb-132">클라이언트 및 서비스의 전송 창 크기는 발신자와 수신자가 적절한 동기화 창 내에 있도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-132">The transfer window size on the client and service ensures that the sender and receiver are within a reasonable window of synchronization.</span></span>

<span data-ttu-id="b0bcb-133"><xref:System.ServiceModel.Channels.ReliableSessionBindingElement.FlowControlEnabled%2A> `true` Wcf 클라이언트와 wcf 서비스 간에 신뢰할 수 있는 세션을 사용 하는 경우 속성을로 설정 하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-133">We highly recommended that you set the property <xref:System.ServiceModel.Channels.ReliableSessionBindingElement.FlowControlEnabled%2A> to `true` when you're using a reliable session between a WCF client and a WCF service.</span></span>

## <a name="setting-maxpendingchannels"></a><span data-ttu-id="b0bcb-134">MaxPendingChannels 설정</span><span class="sxs-lookup"><span data-stu-id="b0bcb-134">Setting MaxPendingChannels</span></span>

<span data-ttu-id="b0bcb-135">서로 다른 클라이언트에서 신뢰할 수 있는 세션 통신을 가능 하 게 하는 서비스를 작성할 때 많은 클라이언트에서 동시에 서비스에 대 한 신뢰할 수 있는 세션을 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-135">When writing a service that enables reliable session communication from different clients, it's possible to have many clients establish a reliable session to the service at the same time.</span></span> <span data-ttu-id="b0bcb-136">이 경우 서비스 응답은 `MaxPendingChannels` 속성에 따라 달라집니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-136">The response of the service in these situations depends on the `MaxPendingChannels` property.</span></span>

<span data-ttu-id="b0bcb-137">발신자가 수신자에 대해 신뢰할 수 있는 세션 채널을 만드는 경우 발신자와 수신자 간의 핸드셰이크에서 신뢰할 수 있는 세션이 설정됩니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-137">When the sender creates a reliable session channel to a receiver, a handshake between them establishes a reliable session.</span></span> <span data-ttu-id="b0bcb-138">신뢰할 수 있는 세션이 설정된 후 채널은 서비스에서 허용할 수 있도록 보류 중인 채널 큐에 저장됩니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-138">After the reliable session is established, the channel is put in a pending channel queue for acceptance by the service.</span></span> <span data-ttu-id="b0bcb-139">`MaxPendingChannels` 속성은 이 상태에 있을 수 있는 채널 수를 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-139">The `MaxPendingChannels` property indicates how many channels can be in this state.</span></span>

<span data-ttu-id="b0bcb-140">서비스가 더 이상 채널을 허용할 수 없는 상태에 있을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-140">It's possible for the service to be in a state where it can't accept more channels.</span></span> <span data-ttu-id="b0bcb-141">큐가 가득 찬 경우에는 신뢰할 수 있는 세션을 설정 하는 시도가 거부 되며 클라이언트는 다시 시도해 야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-141">If the queue is full, an attempt to establish a reliable session is rejected, and the client must retry.</span></span>

<span data-ttu-id="b0bcb-142">큐의 보류 중인 채널이 긴 기간 동안 큐에 남아 있을 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-142">It's also possible that the pending channels in the queue remain in the queue for a longer duration.</span></span> <span data-ttu-id="b0bcb-143">그 동안에는 신뢰할 수 있는 세션에 대 한 비활성 시간 제한이 발생 하 여 채널이 오류가 발생 한 상태로 전환 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-143">In the meantime, an inactivity timeout on the reliable session may occur, causing the channel to transition to a faulted state.</span></span>

<span data-ttu-id="b0bcb-144">여러 클라이언트를 동시에 서비스 하는 서비스를 작성 하는 경우 요구 사항에 적합 한 값을 설정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-144">When writing a service that services multiple clients simultaneously, you should set a value that's suitable for your needs.</span></span> <span data-ttu-id="b0bcb-145">속성 값을 너무 높게 설정 하면 `MaxPendingChannels` 작업 집합에 영향을 줍니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-145">Setting too high a value for the `MaxPendingChannels` property impacts your working set.</span></span>

<span data-ttu-id="b0bcb-146">의 기본값은 <xref:System.ServiceModel.Channels.ReliableSessionBindingElement.MaxPendingChannels%2A> 4 개의 채널입니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-146">The default value for <xref:System.ServiceModel.Channels.ReliableSessionBindingElement.MaxPendingChannels%2A> is four channels.</span></span>

## <a name="reliable-sessions-and-hosting"></a><span data-ttu-id="b0bcb-147">신뢰할 수 있는 세션 및 호스팅</span><span class="sxs-lookup"><span data-stu-id="b0bcb-147">Reliable sessions and hosting</span></span>

<span data-ttu-id="b0bcb-148">웹에서 신뢰할 수 있는 세션을 사용 하는 서비스를 호스팅하는 경우 다음과 같은 중요 한 사항을 고려해 야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-148">When web hosting a service that uses reliable sessions, you should keep the following important considerations in mind:</span></span>

- <span data-ttu-id="b0bcb-149">신뢰할 수 있는 세션은 상태 저장 세션이며 상태는 AppDomain에 유지됩니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-149">Reliable sessions are stateful, and state is maintained in the AppDomain.</span></span> <span data-ttu-id="b0bcb-150">따라서 신뢰할 수 있는 세션의 일부인 모든 메시지는 동일한 AppDomain에서 처리되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-150">This means that all messages that are part of a reliable session must be processed in the same AppDomain.</span></span> <span data-ttu-id="b0bcb-151">팜 또는 정원의 크기가 한 노드 보다 큰 웹 팜 및 웹 가든은이 제약 조건을 보장할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-151">Web farms and web gardens where the size of the farm or garden is greater than one node can't guarantee this constraint.</span></span>

- <span data-ttu-id="b0bcb-152">이중 HTTP 채널을 사용 하는 신뢰할 수 있는 세션 (예:를 사용 하는 경우 `WsDualHttpBinding` )은 클라이언트 당 두 HTTP 연결의 기본값 보다 더 많은 요구를 요구 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-152">Reliable sessions using dual HTTP channels (for example, using `WsDualHttpBinding`) can require more than the default of two HTTP connections per-client.</span></span> <span data-ttu-id="b0bcb-153">즉, 동시 응용 프로그램 및 프로토콜 메시지가 지정 된 시간에 매번 전송 될 수 있으므로 신뢰할 수 있는 이중 세션에는 각 방법으로 최대 2 개의 연결이 필요할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-153">This means a duplex reliable session can require up to two connections each way because concurrent application and protocol messages may be transferring each way at any given time.</span></span> <span data-ttu-id="b0bcb-154">서비스의 메시지 교환 패턴에 따라 특정 조건에서 이중 HTTP 및 신뢰할 수 있는 세션을 사용 하 여 웹 호스팅 서비스의 교착 상태를 발생 시킬 수 있음을 의미 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-154">Under certain conditions depending on the message exchange pattern of the service, this means that it's possible to deadlock a web-hosted service using dual HTTP and reliable sessions.</span></span> <span data-ttu-id="b0bcb-155">클라이언트 별로 허용 되는 HTTP 연결 수를 늘리려면 관련 구성 파일에 다음을 추가 합니다 (예: 해당 서비스의 *web.config* ).</span><span class="sxs-lookup"><span data-stu-id="b0bcb-155">To increase the number of allowable HTTP connections per client, add the following to the relevant configuration file (for example, *web.config* of the service in question):</span></span>

  ```xml
  <configuration>
    <system.net>
      <connectionManagement>
        <add name="*" maxconnection="4" />
      </connectionManagement>
    </system.net>
  </configuration>
  ```

  <span data-ttu-id="b0bcb-156">특성의 값은 `maxconnection` 필요한 연결 수입니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-156">The value of the `maxconnection` attribute is the number of connections needed.</span></span> <span data-ttu-id="b0bcb-157">이 경우 최소는 네 개의 연결 이어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0bcb-157">The minimum in this case should be four connections.</span></span>
