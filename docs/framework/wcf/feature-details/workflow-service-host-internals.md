---
description: '자세한 정보: 워크플로 서비스 호스트 내부'
title: 워크플로 서비스 호스트 내부 기능
ms.date: 03/30/2017
ms.assetid: af44596f-bf6a-4149-9f04-08d8e8f45250
ms.openlocfilehash: fb33e7d6f4e9f78c06459f3d7c8b5c44e2a44a7d
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 02/06/2021
ms.locfileid: "99704383"
---
# <a name="workflow-service-host-internals"></a><span data-ttu-id="8342f-103">워크플로 서비스 호스트 내부 기능</span><span class="sxs-lookup"><span data-stu-id="8342f-103">Workflow Service Host Internals</span></span>

<span data-ttu-id="8342f-104"><xref:System.ServiceModel.WorkflowServiceHost>에서는 워크플로 서비스에 대한 호스트를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-104"><xref:System.ServiceModel.WorkflowServiceHost> provides a host for workflow services.</span></span> <span data-ttu-id="8342f-105">들어오는 메시지를 수신 대기하여 적절한 워크플로 서비스 인스턴스로 라우팅하고 유휴 워크플로의 언로드 및 유지를 제어하는 등의 작업을 담당합니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-105">It is responsible for listening for incoming messages and routing them to the appropriate workflow service instance, it controls unloading and persisting of idle workflows, and more.</span></span> <span data-ttu-id="8342f-106">이 항목에서는 WorkflowServiceHost가 들어오는 메시지를 처리하는 방법을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-106">This topic describes how WorkflowServiceHost processes incoming messages.</span></span>  
  
## <a name="workflowservicehost-overview"></a><span data-ttu-id="8342f-107">WorkflowServiceHost 개요</span><span class="sxs-lookup"><span data-stu-id="8342f-107">WorkflowServiceHost Overview</span></span>  

<span data-ttu-id="8342f-108"><xref:System.ServiceModel.WorkflowServiceHost> 클래스는 워크플로 서비스를 호스트하는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-108">The <xref:System.ServiceModel.WorkflowServiceHost> class is used to host workflow services.</span></span> <span data-ttu-id="8342f-109">들어오는 메시지를 수신 대기하여 적절한 서비스 인스턴스로 라우팅하고 필요에 따라 새 인스턴스를 만들거나 영구 스토리지에서 기존 인스턴스를 로드합니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-109">It listens for incoming messages and routes them to the appropriate service instance, creating new instances or loading existing instances from durable storage as needed.</span></span> <span data-ttu-id="8342f-110">다음 다이어그램에서는가 작동 하는 방식을 대략적으로 보여 줍니다 <xref:System.ServiceModel.WorkflowServiceHost> .</span><span class="sxs-lookup"><span data-stu-id="8342f-110">The following diagram illustrates on a high level how <xref:System.ServiceModel.WorkflowServiceHost> works:</span></span>
  
 ![워크플로 서비스 호스트에 대 한 개요를 보여 주는 다이어그램입니다.](./media/workflow-service-host-internals/workflow-service-host-high-level-overview.gif)  
  
 <span data-ttu-id="8342f-112">이 다이어그램에서는 <xref:System.ServiceModel.WorkflowServiceHost>가 .xamlx 파일에서 워크플로 서비스 정의를 로드하고 구성 파일에서 구성 정보를 로드하는 것을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-112">This diagram shows that <xref:System.ServiceModel.WorkflowServiceHost> loads workflow service definitions from .xamlx files and loads configuration information from a configuration file.</span></span> <span data-ttu-id="8342f-113">또한 추적 프로필에서 추적 구성을 로드합니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-113">It also loads tracking configuration from the tracking profile.</span></span> <span data-ttu-id="8342f-114"><xref:System.ServiceModel.WorkflowServiceHost>는 제어 작업을 워크플로 인스턴스로 보내는 데 사용할 수 있는 워크플로 제어 엔드포인트를 노출합니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-114"><xref:System.ServiceModel.WorkflowServiceHost> exposes a workflow control endpoint which allows you to send control operations to workflow instances.</span></span>  <span data-ttu-id="8342f-115">자세한 내용은 [워크플로 제어 끝점 샘플](workflow-control-endpoint.md)을 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="8342f-115">For more information see [Workflow Control Endpoint sample](workflow-control-endpoint.md).</span></span>  
  
 <span data-ttu-id="8342f-116"><xref:System.ServiceModel.WorkflowServiceHost>는 들어오는 애플리케이션 메시지를 수신 대기하는 애플리케이션 엔드포인트도 노출합니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-116"><xref:System.ServiceModel.WorkflowServiceHost> also exposes application endpoints that listen for incoming application messages.</span></span> <span data-ttu-id="8342f-117">들어오는 메시지가 도착하면 적절한 워크플로 서비스 인스턴스로 전송됩니다(현재 로드되어 있는 경우).</span><span class="sxs-lookup"><span data-stu-id="8342f-117">When an incoming message arrives it is sent to the appropriate workflow service instance (if it is currently loaded).</span></span> <span data-ttu-id="8342f-118">필요한 경우 새 워크플로 인스턴스가 만들어지고,</span><span class="sxs-lookup"><span data-stu-id="8342f-118">If needed a new workflow instance is created.</span></span> <span data-ttu-id="8342f-119">기존 인스턴스가 유지된 경우에는 지속성 저장소에서 로드됩니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-119">Or if an existing instance has been persisted it is loaded from the persistence store.</span></span>  
  
## <a name="workflowservicehost-details"></a><span data-ttu-id="8342f-120">WorkflowServiceHost 세부 정보</span><span class="sxs-lookup"><span data-stu-id="8342f-120">WorkflowServiceHost Details</span></span>  

 <span data-ttu-id="8342f-121">다음 다이어그램에서는 <xref:System.ServiceModel.WorkflowServiceHost> 에서 메시지를 좀 더 자세히 처리 하는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-121">The following diagram shows how <xref:System.ServiceModel.WorkflowServiceHost> handles messages in a bit more detail:</span></span>  
  
 ![워크플로 서비스 호스트 메시지 흐름을 보여 주는 다이어그램입니다.](./media/workflow-service-host-internals/workflow-service-host-message-flow.gif)  
  
 <span data-ttu-id="8342f-123">이 다이어그램에서는 세 가지 엔드포인트인 애플리케이션 엔드포인트, 워크플로 제어 엔드포인트 및 워크플로 호스팅 엔드포인트를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-123">This diagram shows three different endpoints, an application endpoint, a workflow control endpoint, and a workflow hosting endpoint.</span></span> <span data-ttu-id="8342f-124">애플리케이션 엔드포인트는 특정 워크플로 인스턴스에 바인딩된 메시지를 받습니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-124">The application endpoint receives messages that are bound for a specific workflow instance.</span></span> <span data-ttu-id="8342f-125">워크플로 제어 엔드포인트는 제어 작업을 수신 대기합니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-125">The workflow control endpoint listens for control operations.</span></span> <span data-ttu-id="8342f-126">워크플로 호스팅 엔드포인트는 <xref:System.ServiceModel.WorkflowServiceHost>가 서비스가 아닌 워크플로를 로드하고 실행하도록 하는 메시지를 수신 대기합니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-126">The workflow hosting endpoint listens for messages that cause <xref:System.ServiceModel.WorkflowServiceHost> to load and execute non-service workflows.</span></span> <span data-ttu-id="8342f-127">다이어그램에 나와 있듯이 모든 메시지는 WCF 런타임을 통해 처리됩니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-127">As shown in the diagram all messages are processed through the WCF runtime.</span></span>  <span data-ttu-id="8342f-128">워크플로 서비스 인스턴스 제한은 <xref:System.ServiceModel.Description.ServiceThrottlingBehavior.MaxConcurrentInstances%2A> 속성을 사용하여 구현됩니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-128">Workflow service instance throttling is achieved by using the <xref:System.ServiceModel.Description.ServiceThrottlingBehavior.MaxConcurrentInstances%2A> property.</span></span> <span data-ttu-id="8342f-129">이 속성은 동시 워크플로 서비스 인스턴스 수를 제한합니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-129">This property will limit the number of concurrent workflow service instances.</span></span> <span data-ttu-id="8342f-130">이 제한을 초과하면 새 워크플로 서비스 인스턴스에 대한 추가 요청이나 지속형 워크플로 인스턴스 활성화 요청이 큐에 저장됩니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-130">When this throttle is exceeded any additional requests for new workflow service instances or requests to activate persisted workflow instances will be queued.</span></span> <span data-ttu-id="8342f-131">큐에 대기 중인 요청은 새 인스턴스에 대한 요청인지, 실행 중인 지속형 인스턴스에 대한 요청인지에 관계없이 FIFO 순서대로 처리됩니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-131">The queued requests are processed in FIFO order regardless of whether they are requests for a new instance or a running, persisted instance.</span></span> <span data-ttu-id="8342f-132">처리되지 않은 예외가 처리되는 방법과 유휴 워크플로 서비스가 언로드되고 지속되는 방법을 결정하는 호스트 정책 정보가 로드됩니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-132">Host policy information is loaded that determines how unhandled exceptions are dealt with, and how idle workflow services are unloaded and persisted.</span></span> <span data-ttu-id="8342f-133">이러한 항목에 대 한 자세한 내용은 [방법: workflowservicehost를 사용 하 여 워크플로 처리 되지 않은 예외 동작 구성](config-workflow-unhandled-exception-workflowservicehost.md) 및 [방법: workflowservicehost를 사용 하 여 유휴 동작 구성](how-to-configure-idle-behavior-with-workflowservicehost.md)을 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="8342f-133">For more information about these topics see [How to: Configure Workflow Unhandled Exception Behavior with WorkflowServiceHost](config-workflow-unhandled-exception-workflowservicehost.md) and [How to: Configure Idle Behavior with WorkflowServiceHost](how-to-configure-idle-behavior-with-workflowservicehost.md).</span></span> <span data-ttu-id="8342f-134">워크플로 인스턴스는 호스트 정책에 따라 유지되고 필요한 경우 다시 로드됩니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-134">Workflow instances are persisted according to host policies and are reloaded when needed.</span></span> <span data-ttu-id="8342f-135">워크플로 지 속성에 대 한 자세한 내용은 [방법: WorkflowServiceHost를 사용 하 여 지 속성 구성](how-to-configure-persistence-with-workflowservicehost.md), [장기 실행 워크플로 서비스 만들기](creating-a-long-running-workflow-service.md)및 [워크플로 지 속성](../../windows-workflow-foundation/workflow-persistence.md)을 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="8342f-135">For more information about workflow persistence see: [How to: Configure Persistence with WorkflowServiceHost](how-to-configure-persistence-with-workflowservicehost.md), [Creating a Long-running Workflow Service](creating-a-long-running-workflow-service.md), and [Workflow Persistence](../../windows-workflow-foundation/workflow-persistence.md).</span></span>  
  
 <span data-ttu-id="8342f-136">다음 그림에서는 WorkflowServiceHost. Open이 호출 되는 경우의 흐름을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-136">The following illustration shows the flow when WorkflowServiceHost.Open is called:</span></span>  
  
 ![WorkflowServiceHost를 호출할 때 흐름을 표시 하는 다이어그램입니다.](./media/workflow-service-host-internals/workflow-service-host-open.gif)  
  
 <span data-ttu-id="8342f-138">워크플로가 XAML에서 로드되고 작업 트리가 만들어집니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-138">The workflow is loaded from XAML and the activity tree is created.</span></span> <span data-ttu-id="8342f-139"><xref:System.ServiceModel.WorkflowServiceHost>가 작업 트리를 단계별로 진행하면서 서비스 설명을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-139"><xref:System.ServiceModel.WorkflowServiceHost> walks the activity tree and creates the service description.</span></span> <span data-ttu-id="8342f-140">구성이 호스트에 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-140">Configuration is applied to the host.</span></span> <span data-ttu-id="8342f-141">마지막으로 호스트가 들어오는 메시지를 수신 대기하기 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-141">Finally the host begins to listen for incoming messages.</span></span>  
  
 <span data-ttu-id="8342f-142">다음 그림에서는 <xref:System.ServiceModel.WorkflowServiceHost> CanCreateInstance가로 설정 된 Receive 작업에 바인딩된 메시지를 받을 때에서 수행 하는 작업을 보여 줍니다 `true` .</span><span class="sxs-lookup"><span data-stu-id="8342f-142">The following illustration shows what the <xref:System.ServiceModel.WorkflowServiceHost> does when it receives a message bound for a Receive activity that has CanCreateInstance set to `true`:</span></span>  
  
 ![워크플로 호스트에서 메시지를 받고 CanCreateInstance가 true 일 때 사용 하는 의사 결정 트리입니다.](./media/workflow-service-host-internals/workflow-service-host-receive-message-cancreateinstance.gif)  
  
 <span data-ttu-id="8342f-144">메시지가 도착하고 WCF 채널 스택에서 처리됩니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-144">The message arrives and is processed by the WCF channel stack.</span></span> <span data-ttu-id="8342f-145">스로틀이 확인되고 상관 관계 쿼리가 실행됩니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-145">Throttles are checked and correlation queries are executed.</span></span> <span data-ttu-id="8342f-146">메시지가 기존 인스턴스에 바인딩된 경우 메시지가 배달됩니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-146">If the message is bound for an existing instance the message is delivered.</span></span> <span data-ttu-id="8342f-147">새 인스턴스를 만들어야 하는 경우에는 Receive 활동의 CanCreateInstance 속성이 확인됩니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-147">If a new instance needs to be created, the Receive activity’s CanCreateInstance property is checked.</span></span> <span data-ttu-id="8342f-148">이 속성이 true로 설정되었으면 새 인스턴스가 만들어지고 메시지가 배달됩니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-148">If it is set to true, a new instance is created and the message is delivered.</span></span>  
  
 <span data-ttu-id="8342f-149">다음 그림에서는 <xref:System.ServiceModel.WorkflowServiceHost>에서 CanCreateInstance가 false로 설정된 Receive 작업에 바인딩된 메시지를 받을 때 수행하는 작업을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-149">The following illustration shows what the <xref:System.ServiceModel.WorkflowServiceHost> does when it receives a message bound for a Receive activity that has CanCreateInstance set to false.</span></span>  
  
 ![워크플로 호스트에서 메시지를 받을 때 사용 하는 의사 결정 트리와 CanCreateInstance가 false입니다.](./media/workflow-service-host-internals/workflow-service-host-receive-message.gif)  
  
 <span data-ttu-id="8342f-151">메시지가 도착하고 WCF 채널 스택에서 처리됩니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-151">The message arrives and is processed by the WCF channel stack.</span></span> <span data-ttu-id="8342f-152">스로틀이 확인되고 상관 관계 쿼리가 실행됩니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-152">Throttles are checked and correlation queries are executed.</span></span> <span data-ttu-id="8342f-153">메시지가 기존 인스턴스에 바인딩되어 있으므로(CanCreateInstance가 false이기 때문) 인스턴스가 지속성 저장소에서 로드되고 책갈피가 다시 시작되며 워크플로가 실행됩니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-153">The message is bound for an existing instance (because CanCreateInstance is false) so the instance is loaded from persistence store, the bookmark is resumed and the workflow executes.</span></span>  
  
> [!WARNING]
> <span data-ttu-id="8342f-154">SQL Server가 NamedPipe 프로토콜에서만 수신하도록 구성되어 있으면 워크플로 서비스 호스트가 열리지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="8342f-154">Workflow Service Host will fail to open if SQL Server is configured to listen on NamedPipe protocol only.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8342f-155">참고 항목</span><span class="sxs-lookup"><span data-stu-id="8342f-155">See also</span></span>

- [<span data-ttu-id="8342f-156">워크플로 서비스</span><span class="sxs-lookup"><span data-stu-id="8342f-156">Workflow Services</span></span>](workflow-services.md)
- [<span data-ttu-id="8342f-157">워크플로 서비스 호스팅</span><span class="sxs-lookup"><span data-stu-id="8342f-157">Hosting Workflow Services</span></span>](hosting-workflow-services.md)
- [<span data-ttu-id="8342f-158">워크플로 제어 엔드포인트</span><span class="sxs-lookup"><span data-stu-id="8342f-158">Workflow Control Endpoint</span></span>](workflow-control-endpoint.md)
- [<span data-ttu-id="8342f-159">방법: WorkflowServiceHost를 사용하여 워크플로의 처리되지 않은 예외 동작 구성</span><span class="sxs-lookup"><span data-stu-id="8342f-159">How to: Configure Workflow Unhandled Exception Behavior with WorkflowServiceHost</span></span>](config-workflow-unhandled-exception-workflowservicehost.md)
- [<span data-ttu-id="8342f-160">장기 실행 워크플로 서비스 만들기</span><span class="sxs-lookup"><span data-stu-id="8342f-160">Creating a Long-running Workflow Service</span></span>](creating-a-long-running-workflow-service.md)
- [<span data-ttu-id="8342f-161">워크플로 유지</span><span class="sxs-lookup"><span data-stu-id="8342f-161">Workflow Persistence</span></span>](../../windows-workflow-foundation/workflow-persistence.md)
