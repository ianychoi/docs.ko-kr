---
title: 메시지 로깅에 대한 보안 고려 사항
ms.date: 03/30/2017
ms.assetid: 21f513f2-815b-47f3-85a6-03c008510038
ms.openlocfilehash: 8594329fb27aa1d77a2baffee2a7e37ea0d009c4
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 11/26/2020
ms.locfileid: "96283772"
---
# <a name="security-concerns-for-message-logging"></a><span data-ttu-id="d02a5-102">메시지 로깅에 대한 보안 고려 사항</span><span class="sxs-lookup"><span data-stu-id="d02a5-102">Security Concerns for Message Logging</span></span>

<span data-ttu-id="d02a5-103">이 항목에서는 메시지 로깅에 의해 생성된 이벤트뿐 아니라 중요한 데이터가 메시지 로그에서 노출되지 않도록 보호하는 방법에 대해 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-103">This topic describes how you can protect sensitive data from being exposed in message logs, as well as events generated by message logging.</span></span>  
  
## <a name="security-concerns"></a><span data-ttu-id="d02a5-104">보안 고려 사항</span><span class="sxs-lookup"><span data-stu-id="d02a5-104">Security Concerns</span></span>  
  
### <a name="logging-sensitive-information"></a><span data-ttu-id="d02a5-105">중요한 정보 로깅</span><span class="sxs-lookup"><span data-stu-id="d02a5-105">Logging Sensitive Information</span></span>  

 <span data-ttu-id="d02a5-106">WCF (Windows Communication Foundation)는 응용 프로그램별 헤더 및 본문의 데이터를 수정 하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-106">Windows Communication Foundation (WCF) does not modify any data in application-specific headers and body.</span></span> <span data-ttu-id="d02a5-107">또한 WCF는 응용 프로그램별 헤더 또는 본문 데이터에서 개인 정보를 추적 하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-107">WCF also does not track personal information in application-specific headers or body data.</span></span>  
  
 <span data-ttu-id="d02a5-108">메시지 로깅을 사용하도록 설정하면 쿼리 문자열 등의 애플리케이션별 헤더와 신용 카드 번호 등의 본문 정보에 있는 개인 정보가 로그에 표시될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-108">When message logging is enabled, personal information in application-specific headers, such as, a query string; and body information, such as, a credit card number, can become visible in the logs.</span></span> <span data-ttu-id="d02a5-109">애플리케이션 배포자는 구성 및 로그 파일에 액세스 제어를 적용하는 작업을 담당합니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-109">The application deployer is responsible for enforcing access control on the configuration and log files.</span></span> <span data-ttu-id="d02a5-110">이런 종류의 정보가 표시되지 않도록 하려면 로깅을 사용하지 않도록 설정하거나 로그를 공유하려는 데이터의 일부를 필터링해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-110">If you do not want this kind of information to be visible, you should disable logging, or filter out part of the data if you want to share the logs.</span></span>  
  
 <span data-ttu-id="d02a5-111">다음 팁은 로그 파일의 내용이 실수로 노출되지 않도록 보호하는 데 도움이 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-111">The following tips can help you to prevent the content of a log file from being exposed unintentionally:</span></span>  
  
- <span data-ttu-id="d02a5-112">로그 파일이 웹 호스트 및 자체 호스트 시나리오 둘 다에서 ACL(액세스 제어 목록)을 통해 보호되는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-112">Ensure that the log files are protected by Access Control Lists (ACL) both in Web-host and self-host scenarios.</span></span>  
  
- <span data-ttu-id="d02a5-113">웹 요청을 사용하여 쉽게 제공될 수 없는 파일 확장명을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-113">Choose a file extension that cannot be easily served using a Web request.</span></span> <span data-ttu-id="d02a5-114">예를 들어 .xml 파일 확장명을 사용하는 것은 안전하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-114">For example, the .xml file extension is not a safe choice.</span></span> <span data-ttu-id="d02a5-115">제공될 수 있는 확장명 목록을 보기 위해 IIS(인터넷 정보 서비스) 관리 설명서를 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-115">You can check the Internet Information Services (IIS) administration guide to see a list of extensions that can be served.</span></span>  
  
- <span data-ttu-id="d02a5-116">로그 파일 위치의 절대 경로를 지정합니다. 절대 경로는 웹 브라우저를 사용하여 외부 사용자가 해당 파일에 액세스하지 못하도록 웹 호스트 vroot 공용 디렉터리의 외부에 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-116">Specify an absolute path for the log file location, which should be outside of the Web host vroot public directory to prevent it from being accessed by an external party using a Web browser.</span></span>  
  
 <span data-ttu-id="d02a5-117">기본적으로 사용자 이름 및 암호와 같은 PII(개인적으로 식별할 수 있는 정보)와 키는 추적 및 기록된 메시지에 기록되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-117">By default, keys and personally identifiable information (PII) such as username and password are not logged in traces and logged messages.</span></span> <span data-ttu-id="d02a5-118">그러나 컴퓨터 관리자는 Machine.config 파일의 `enableLoggingKnownPII` 요소에 있는 `machineSettings` 특성을 사용하여 컴퓨터에서 실행되는 애플리케이션이 알려진 PII(개인적으로 식별할 수 있는 정보)를 기록하도록 허용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-118">A machine administrator, however, can use the `enableLoggingKnownPII` attribute in the `machineSettings` element of the Machine.config file to permit applications running on the machine to log known personally identifiable information (PII).</span></span> <span data-ttu-id="d02a5-119">다음 구성 파일에서 이 작업을 수행하는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-119">The following configuration demonstrates how to do this:</span></span>  
  
```xml  
<configuration>  
   <system.serviceModel>  
      <machineSettings enableLoggingKnownPii="true"/>  
   </system.serviceModel>  
</configuration>
```  
  
 <span data-ttu-id="d02a5-120">그런 다음 애플리케이션 배포자는 App.config 또는 Web.config 파일 중 하나에 있는 `logKnownPii` 특성을 사용하여 다음과 같이 PII 로깅을 사용하도록 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-120">An application deployer can then use the `logKnownPii` attribute in either the App.config or Web.config file to enable PII logging as follows:</span></span>  
  
```xml  
<system.diagnostics>  
  <sources>  
      <source name="System.ServiceModel.MessageLogging"  
        logKnownPii="true">  
        <listeners>  
                 <add name="messages"  
                 type="System.Diagnostics.XmlWriterTraceListener"  
                 initializeData="c:\logs\messages.svclog" />  
          </listeners>  
      </source>  
    </sources>  
</system.diagnostics>  
```  
  
 <span data-ttu-id="d02a5-121">두 개의 설정 모두 `true`인 경우에만 PII 로깅을 사용하도록 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-121">Only when both settings are `true` is PII logging enabled.</span></span> <span data-ttu-id="d02a5-122">두 스위치를 조합하면 각 애플리케이션에 대해 알려진 PII를 유연하게 기록할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-122">The combination of two switches allows the flexibility to log known PII for each application.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="d02a5-123">또한 [!INCLUDE[netfx_current_long](../../../../includes/netfx-current-long-md.md)]에서 Web.config 파일 또는 App.config 파일의 `logEntireMessage` 및 `logKnownPii` 플래그를 `true`로 설정하여 다음 예제 `<system.serviceModel><messageLogging logEntireMessage="true" logKnownPii="true" …`와 같이 PII 로깅을 사용하도록 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-123">In [!INCLUDE[netfx_current_long](../../../../includes/netfx-current-long-md.md)] the `logEntireMessage` and `logKnownPii` flags must also be set to `true` in the Web.config file or the App.config file to enable PII logging, as show in the following example `<system.serviceModel><messageLogging logEntireMessage="true" logKnownPii="true" …`.</span></span>  
  
 <span data-ttu-id="d02a5-124">하나의 구성 파일에서 두 개 이상의 사용자 지정 소스를 지정할 경우 첫 번째 소스의 특성만 읽는다는 점에 유의해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-124">You should be aware that if you specify two or more custom sources in a configuration file, only the attributes of the first source are read.</span></span> <span data-ttu-id="d02a5-125">다른 소스는 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-125">The others are ignored.</span></span> <span data-ttu-id="d02a5-126">이는 다음 App.config 파일의 경우, 두 번째 소스에 PII 로깅을 사용하도록 명시적으로 설정되어 있더라도 두 개의 소스 모두에 대해 PII가 기록되지는 않는다는 것을 의미합니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-126">This means that, for the following App.config, file, PII is not logged for both sources even though PII logging is explicitly enabled for the second source.</span></span>  
  
```xml  
<system.diagnostics>  
   <sources>  
      <source name="System.ServiceModel.MessageLogging"  
              logKnownPii="false">  
              <listeners>  
                 <add name="messages"  
                      type="System.Diagnostics.XmlWriterTraceListener"  
                      initializeData="c:\logs\messages.svclog" />  
              </listeners>  
            </source>  
      <source name="System.ServiceModel"
              logKnownPii="true">  
              <listeners>  
                 <add name="traces"  
                      type="System.Diagnostics.XmlWriterTraceListener"  
                      initializeData="c:\logs\traces.svclog" />  
              </listeners>  
      </source>  
   </sources>  
</system.diagnostics>  
```  
  
 <span data-ttu-id="d02a5-127">`<machineSettings enableLoggingKnownPii="Boolean"/>` 요소가 Machine.config 파일의 외부에 존재할 경우 시스템은 <xref:System.Configuration.ConfigurationErrorsException>을 throw합니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-127">If the `<machineSettings enableLoggingKnownPii="Boolean"/>` element exists outside the Machine.config file, the system throws a <xref:System.Configuration.ConfigurationErrorsException>.</span></span>  
  
 <span data-ttu-id="d02a5-128">변경 내용은 애플리케이션이 시작되거나 다시 시작되어야만 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-128">The changes are effective only when the application starts or restarts.</span></span> <span data-ttu-id="d02a5-129">두 개의 특성이 모두 `true`로 설정된 경우에 시작 시 이벤트가 기록됩니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-129">An event is logged at startup when both attributes are set to `true`.</span></span> <span data-ttu-id="d02a5-130">`logKnownPii`가 `true`로 설정되어 있지만 `enableLoggingKnownPii`는 `false`인 경우에도 이벤트가 기록됩니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-130">An event is also logged if `logKnownPii` is set to `true` but `enableLoggingKnownPii` is `false`.</span></span>  
  
 <span data-ttu-id="d02a5-131">컴퓨터 관리자와 애플리케이션 배포자는 이러한 두 개의 스위치를 사용할 때 특별히 주의를 기울여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-131">The machine administrator and application deployer should exercise extreme caution when using these two switches.</span></span> <span data-ttu-id="d02a5-132">PII 로깅을 사용하도록 설정하면 보안 키와 PII가 기록됩니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-132">If PII logging is enabled, security keys and PII are logged.</span></span> <span data-ttu-id="d02a5-133">PII 로깅을 사용하지 않도록 설정해도 중요한 데이터와 애플리케이션별 데이터는 메시지 헤더 및 본문에 기록됩니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-133">If it is disabled, sensitive and application-specific data is still logged in message headers and bodies.</span></span> <span data-ttu-id="d02a5-134">개인 정보 보호 및 PII의 노출을 방지 하는 방법에 대 한 자세한 내용은 [사용자 개인 정보](/previous-versions/dotnet/articles/aa480490(v=msdn.10))를 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="d02a5-134">For a more thorough discussion about privacy and protecting PII from being exposed, see [User Privacy](/previous-versions/dotnet/articles/aa480490(v=msdn.10)).</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="d02a5-135">잘못된 형식의 메시지에서는 PII가 숨겨지지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-135">PII is not hidden in malformed messages.</span></span> <span data-ttu-id="d02a5-136">이와 같은 메시지는 수정 사항 없이 있는 그대로 기록됩니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-136">Such messaged are logged as-is without any modification.</span></span> <span data-ttu-id="d02a5-137">이전에 언급한 특성은 이에 영향을 주지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-137">Attributes mentioned previously have no effect on this.</span></span>  
  
### <a name="custom-trace-listener"></a><span data-ttu-id="d02a5-138">사용자 지정 추적 수신기</span><span class="sxs-lookup"><span data-stu-id="d02a5-138">Custom Trace Listener</span></span>  

 <span data-ttu-id="d02a5-139">관리자에 대해서는 메시지 로깅 추적 소스에 사용자 지정 추적 수신기를 추가하는 권한을 제한해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-139">Adding a custom trace listener on the Message Logging trace source is a privilege that should be restricted to the administrator.</span></span> <span data-ttu-id="d02a5-140">이는 사용자 지정 수신기가 메시지를 원격으로 보내도록 악의적으로 구성될 수 있으며 이를 통해 중요한 정보가 노출될 수 있기 때문입니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-140">This is because malicious custom listeners can be configured to send messages remotely, which leads to sensitive information disclosure.</span></span> <span data-ttu-id="d02a5-141">또한 원격 데이터베이스와 같은 연결을 통해 메시지를 보내도록 사용자 지정 수신기를 구성할 경우, 원격 컴퓨터의 메시지 로그에 적절한 액세스 제어를 적용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-141">In addition, if you configure a custom listener to send messages on the wire, such as, to a remote database, you should enforce proper access control on the message logs in the remote machine.</span></span>  
  
## <a name="events-triggered-by-message-logging"></a><span data-ttu-id="d02a5-142">메시지 로깅을 통해 트리거되는 이벤트</span><span class="sxs-lookup"><span data-stu-id="d02a5-142">Events Triggered by Message Logging</span></span>  

 <span data-ttu-id="d02a5-143">다음은 메시지 로깅을 통해 내보내지는 모든 이벤트의 목록입니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-143">The following lists all the events emitted by message logging.</span></span>  
  
- <span data-ttu-id="d02a5-144">Message logging on: 이 이벤트는 구성 시 메시지 로깅을 사용하도록 설정하거나 WMI를 통해 내보내집니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-144">Message logging on: This event is emitted when message logging is enabled in configuration, or through WMI.</span></span> <span data-ttu-id="d02a5-145">이벤트의 내용은 "메시지 로깅이 켜졌습니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-145">The content of the event is "Message logging has been turned on.</span></span> <span data-ttu-id="d02a5-146">메시지 본문과 같이 통신 중에 암호화된 경우에도 중요한 정보가 일반 텍스트로 기록됩니다."입니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-146">Sensitive information may be logged in clear text, even if they were encrypted on the wire, for example, message bodies."</span></span>  
  
- <span data-ttu-id="d02a5-147">Message logging off: 이 이벤트는 WML을 통해 메시지 로깅을 사용하지 않도록 설정하면 내보내집니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-147">Message logging off: This event is emitted when message logging is disabled through WMI.</span></span> <span data-ttu-id="d02a5-148">이벤트의 내용은 "메시지 로깅이 꺼졌습니다."입니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-148">The content of the event is "Message logging has been turned off."</span></span>  
  
- <span data-ttu-id="d02a5-149">Log Known PII On: 이 이벤트는 알려진 PII의 로깅을 사용하도록 설정하면 내보내집니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-149">Log Known PII On: This event is emitted when logging of known PII is enabled.</span></span> <span data-ttu-id="d02a5-150">이는 `enableLoggingKnownPii` `machineSettings` Machine.config 파일의 요소에 있는 특성이로 설정 되 `true` 고 `logKnownPii` `source` App.config 또는 Web.config 파일에서 요소의 특성이로 설정 된 경우에 발생 `true` 합니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-150">This happens when the `enableLoggingKnownPii` attribute in the `machineSettings` element of the Machine.config file is set to `true`, and the `logKnownPii` attribute of the `source` element in either the App.config or Web.config file is set to `true`.</span></span>  
  
- <span data-ttu-id="d02a5-151">Log Known PII Not Allowed: 이 이벤트는 알려진 PII의 로깅이 허용되지 않을 때 내보내집니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-151">Log Known PII Not Allowed: This event is emitted when logging of known PII is not allowed.</span></span> <span data-ttu-id="d02a5-152">이는 `logKnownPii` `source` App.config 또는 Web.config 파일에 있는 요소의 특성이로 설정 되어 `true` 있지만 `enableLoggingKnownPii` `machineSettings` Machine.config 파일의 요소에 있는 특성이로 설정 `false` 된 경우에 발생 합니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-152">This happens when the `logKnownPii` attribute of the `source` element in either the App.config or Web.config file is set to `true`, but the `enableLoggingKnownPii` attribute in the `machineSettings` element of the Machine.config file is set to `false`.</span></span> <span data-ttu-id="d02a5-153">예외가 throw되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-153">No exception is thrown.</span></span>  
  
 <span data-ttu-id="d02a5-154">이러한 이벤트는 Windows에 포함된 이벤트 뷰어 도구에서 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d02a5-154">These events can be viewed in the Event Viewer tool that comes with Windows.</span></span> <span data-ttu-id="d02a5-155">이에 대 한 자세한 내용은 [이벤트 로깅](./event-logging/index.md)을 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="d02a5-155">For more information on this, see [Event Logging](./event-logging/index.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d02a5-156">참고 항목</span><span class="sxs-lookup"><span data-stu-id="d02a5-156">See also</span></span>

- [<span data-ttu-id="d02a5-157">메시지 로깅</span><span class="sxs-lookup"><span data-stu-id="d02a5-157">Message Logging</span></span>](message-logging.md)
- [<span data-ttu-id="d02a5-158">보안 고려 사항 및 추적에 대한 유용한 정보</span><span class="sxs-lookup"><span data-stu-id="d02a5-158">Security Concerns and Useful Tips for Tracing</span></span>](./tracing/security-concerns-and-useful-tips-for-tracing.md)
