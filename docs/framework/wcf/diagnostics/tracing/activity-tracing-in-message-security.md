---
description: '자세한 정보: 메시지 보안의 작업 추적'
title: 메시지 보안의 동작 추적
ms.date: 03/30/2017
ms.assetid: 68862534-3b2e-4270-b097-8121b12a2c97
ms.openlocfilehash: 94fb6f60539465dd16e09a968679567e94d6cd24
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 02/06/2021
ms.locfileid: "99770861"
---
# <a name="activity-tracing-in-message-security"></a><span data-ttu-id="eafd5-103">메시지 보안의 동작 추적</span><span class="sxs-lookup"><span data-stu-id="eafd5-103">Activity Tracing in Message Security</span></span>

<span data-ttu-id="eafd5-104">이 항목에서는 보안 처리에 대한 동작 추적에 대해 설명합니다. 동작 추적은 다음과 같은 세 가지 단계로 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-104">This topic describes activity tracing for security processing, which happens in the following three phases.</span></span>  
  
- <span data-ttu-id="eafd5-105">협상/SCT 교환.</span><span class="sxs-lookup"><span data-stu-id="eafd5-105">Negotiation/SCT exchange.</span></span> <span data-ttu-id="eafd5-106">이 단계는 전송 계층(이진 데이터 교환 사용) 또는 메시지 계층(SOAP 메시지 교환 사용)에서 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-106">This can happen at the transport later (through binary data exchange) or message layer (through SOAP message exchanges).</span></span>  
  
- <span data-ttu-id="eafd5-107">서명 확인 및 인증을 통한 메시지 암호화/해독.</span><span class="sxs-lookup"><span data-stu-id="eafd5-107">Message encryption/decryption, with signature verification and authentication.</span></span> <span data-ttu-id="eafd5-108">추적이 앰비언트 동작(일반적으로 "Process Action")에 나타납니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-108">Traces appear in the ambient activity, typically "Process Action."</span></span>  
  
- <span data-ttu-id="eafd5-109">권한 부여 및 확인.</span><span class="sxs-lookup"><span data-stu-id="eafd5-109">Authorization and verification.</span></span> <span data-ttu-id="eafd5-110">엔드포인트 간에 통신할 때 또는 로컬로 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-110">This can happen locally or when communicating between endpoints.</span></span>  
  
## <a name="negotiationsct-exchange"></a><span data-ttu-id="eafd5-111">협상/SCT 교환</span><span class="sxs-lookup"><span data-stu-id="eafd5-111">Negotiation/SCT exchange</span></span>  

 <span data-ttu-id="eafd5-112">협상/SCT 교환 단계에서는 클라이언트에서 "Set up Secure Session" 및 "Close Secure Session"의 두 가지 동작 유형이 만들어집니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-112">In the negotiation/SCT exchange phase, two activity types are created on the client: "Set up Secure Session" and "Close Secure Session."</span></span> <span data-ttu-id="eafd5-113">"Set up Secure Session"은 RST/RSTR/SCT 메시지 교환에 대한 추적을 포함하고, "Close Secure Session"은 취소 메시지에 대한 추적을 포함합니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-113">"Set up Secure Session" encompasses traces for the RST/RSTR/SCT message exchanges, while "Close Secure Session" includes traces for the Cancel message.</span></span>  
  
 <span data-ttu-id="eafd5-114">서버에서 RST/RSTR/SCT에 대한 각 요청/회신이 자체 동작에 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-114">On the server, each request/reply for the RST/RSTR/SCT appears in its own activity.</span></span> <span data-ttu-id="eafd5-115">`propagateActivity` = `true` 서버와 클라이언트 둘 다에서 서버에 있는 작업은 동일한 ID를 가지 며, 서비스 추적 뷰어를 통해 볼 때 "Setup Secure Session"에 함께 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-115">If `propagateActivity`=`true` on both the server and client, activities on the server have the same ID, and appear together in the "Setup Secure Session" when viewed through Service Trace Viewer.</span></span>  
  
 <span data-ttu-id="eafd5-116">이 동작 추적 모델은 사용자 이름/암호 인증, 인증서 인증 및 NTML 인증에 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-116">This activity tracing model is valid for user name/password authentication, certificate authentication, and NTLM authentication.</span></span>  
  
 <span data-ttu-id="eafd5-117">다음 표에서는 협상 및 SCT 교환에 대한 동작과 추적을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-117">The following table lists the activities and traces for negotiation and SCT exchange.</span></span>  
  
||<span data-ttu-id="eafd5-118">협상/SCT 교환 발생 시기</span><span class="sxs-lookup"><span data-stu-id="eafd5-118">Time when Negotiation/SCT exchange happens</span></span>|<span data-ttu-id="eafd5-119">활동</span><span class="sxs-lookup"><span data-stu-id="eafd5-119">Activities</span></span>|<span data-ttu-id="eafd5-120">추적</span><span class="sxs-lookup"><span data-stu-id="eafd5-120">Traces</span></span>|  
|-|-------------------------------------------------|----------------|------------|  
|<span data-ttu-id="eafd5-121">보안 전송</span><span class="sxs-lookup"><span data-stu-id="eafd5-121">Secure Transport</span></span><br /><br /> <span data-ttu-id="eafd5-122">(HTTPS, SSL)</span><span class="sxs-lookup"><span data-stu-id="eafd5-122">(HTTPS, SSL)</span></span>|<span data-ttu-id="eafd5-123">첫 번째 메시지를 수신했을 때</span><span class="sxs-lookup"><span data-stu-id="eafd5-123">On first message received.</span></span>|<span data-ttu-id="eafd5-124">앰비언트 동작에서 추적을 내보냅니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-124">Traces are emitted in the ambient activity.</span></span>|<span data-ttu-id="eafd5-125">-Exchange 추적</span><span class="sxs-lookup"><span data-stu-id="eafd5-125">-   Exchange traces</span></span><br /><span data-ttu-id="eafd5-126">-보안 채널이 설정 됨</span><span class="sxs-lookup"><span data-stu-id="eafd5-126">-   Secure channel established</span></span><br /><span data-ttu-id="eafd5-127">-획득 한 암호를 공유 합니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-127">-   Share secrets obtained.</span></span>|  
|<span data-ttu-id="eafd5-128">보안 메시지 계층</span><span class="sxs-lookup"><span data-stu-id="eafd5-128">Secure Message Layer</span></span><br /><br /> <span data-ttu-id="eafd5-129">(WSHTTP)</span><span class="sxs-lookup"><span data-stu-id="eafd5-129">(WSHTTP)</span></span>|<span data-ttu-id="eafd5-130">첫 번째 메시지를 수신했을 때</span><span class="sxs-lookup"><span data-stu-id="eafd5-130">On first message received.</span></span>|<span data-ttu-id="eafd5-131">클라이언트에서:</span><span class="sxs-lookup"><span data-stu-id="eafd5-131">On the client:</span></span><br /><br /> <span data-ttu-id="eafd5-132">-RST/RSTR/SCT에 대 한 각 요청/회신에 대 한 첫 번째 메시지의 "프로세스 작업"을 "설정 보안 세션"으로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-132">-   "Setup Secure Session" out of "Process Action" of that first message, for each request/reply for RST/RSTR/SCT.</span></span><br /><span data-ttu-id="eafd5-133">-"Close Secure Session" ("close Session activity" out out exchange)</span><span class="sxs-lookup"><span data-stu-id="eafd5-133">-   "Close Secure Session" for the CANCEL exchange, out of the "Close Proxy activity."</span></span> <span data-ttu-id="eafd5-134">이 동작은 보안 세션이 닫힌 시간에 따라 일부 다른 앰비언트 동작에서 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-134">This activity may happen out of some other ambient activity, depending on when the secure session is closed.</span></span><br /><br /> <span data-ttu-id="eafd5-135">서버측:</span><span class="sxs-lookup"><span data-stu-id="eafd5-135">On the server:</span></span><br /><br /> <span data-ttu-id="eafd5-136">-서버에서 RST/SCT/Cancel의 각 요청/회신에 대 한 하나의 "작업 처리" 작업</span><span class="sxs-lookup"><span data-stu-id="eafd5-136">-   One "Process Action" activity for each request/reply for RST/SCT/Cancel on the server.</span></span> <span data-ttu-id="eafd5-137">인 경우 `propagateActivity` = `true` RST/RSTR/SCT 작업이 "보안 세션 설정"으로 병합 되 고 취소가 클라이언트의 "Close" 작업과 병합 됩니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-137">If `propagateActivity`=`true`, RST/RSTR/SCT activities are merged with "Set up Security Session", and Cancel is merged with the "Close" activity from the client.</span></span><br /><br /> <span data-ttu-id="eafd5-138">"Set up Secure Session"에는 다음과 같은 두 가지 단계가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-138">There are two stages for "Set up Secure Session":</span></span><br /><br /> <span data-ttu-id="eafd5-139">1. 인증 협상.</span><span class="sxs-lookup"><span data-stu-id="eafd5-139">1.  Authentication negotiation.</span></span> <span data-ttu-id="eafd5-140">클라이언트에 이미 적절한 자격 증명이 있는 경우 선택 사항입니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-140">This is optional if the client already has the proper credentials.</span></span> <span data-ttu-id="eafd5-141">이 단계는 보안 전송 또는 메시지 교환을 통해 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-141">This phase can be done through secure transport, or through message exchanges.</span></span> <span data-ttu-id="eafd5-142">메시지 교환을 통해 수행할 경우 하나 또는 두 개의 RST/RSTR 교환이 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-142">In the latter case, 1 or 2 RST/RSTR exchanges can happen.</span></span> <span data-ttu-id="eafd5-143">이러한 교환에 대해 앞에서 설명한 대로 새 요청/회신 동작에서 추적을 내보냅니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-143">For these exchanges, traces are emitted in new request/reply activities as previously designed.</span></span><br /><span data-ttu-id="eafd5-144">2. 여기에서 하나의 RST/RSTR 교환이 발생 하는 보안 세션 설정 (SCT).</span><span class="sxs-lookup"><span data-stu-id="eafd5-144">2.  Secure session establishment (SCT), in which one RST/RSTR exchange happens here.</span></span> <span data-ttu-id="eafd5-145">이 단계에는 앞에서 설명한 것과 동일한 앰비언트 동작이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-145">This has the same ambient activities as described previously.</span></span>|<span data-ttu-id="eafd5-146">-Exchange 추적</span><span class="sxs-lookup"><span data-stu-id="eafd5-146">-   Exchange traces</span></span><br /><span data-ttu-id="eafd5-147">-보안 채널이 설정 됨</span><span class="sxs-lookup"><span data-stu-id="eafd5-147">-   Secure channel established</span></span><br /><span data-ttu-id="eafd5-148">-획득 한 암호를 공유 합니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-148">-   Share secrets obtained.</span></span>|  
  
> [!NOTE]
> <span data-ttu-id="eafd5-149">혼합 보안 모드의 경우 이진 교환에서는 협상 인증이 발생하지만 메시지 교환에서는 SCT가 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-149">In mixed security mode, negotiation authentication happens in binary exchanges, but SCT happens in message exchange.</span></span> <span data-ttu-id="eafd5-150">순수 전송 모드의 경우에는 추가 동작이 없는 전송에서만 협상이 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-150">In pure transport mode, negotiation happens only in transport with no additional activities.</span></span>  
  
## <a name="message-encryption-and-decryption"></a><span data-ttu-id="eafd5-151">메시지 암호화 및 해독</span><span class="sxs-lookup"><span data-stu-id="eafd5-151">Message Encryption and Decryption</span></span>  

 <span data-ttu-id="eafd5-152">다음 표에서는 메시지 암호화/해독 및 서명 인증에 대한 활동과 추적을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-152">The following table lists the activities and traces for message encryption/decryption, as well as signature authentication.</span></span>  
  
||<span data-ttu-id="eafd5-153">보안 전송</span><span class="sxs-lookup"><span data-stu-id="eafd5-153">Secure Transport</span></span><br /><br /> <span data-ttu-id="eafd5-154">(HTTPS, SSL) 및 보안 메시지 계층</span><span class="sxs-lookup"><span data-stu-id="eafd5-154">(HTTPS, SSL) and Secure Message Layer</span></span><br /><br /> <span data-ttu-id="eafd5-155">(WSHTTP)</span><span class="sxs-lookup"><span data-stu-id="eafd5-155">(WSHTTP)</span></span>|  
|-|---------------------------------------------------------------------------------|  
|<span data-ttu-id="eafd5-156">메시지 암호화/해독 및 서명 인증 발생 시기</span><span class="sxs-lookup"><span data-stu-id="eafd5-156">Time when message encryption/decryption, as well as signature authentication happens</span></span>|<span data-ttu-id="eafd5-157">메시지를 수신했을 때</span><span class="sxs-lookup"><span data-stu-id="eafd5-157">On message received</span></span>|  
|<span data-ttu-id="eafd5-158">활동</span><span class="sxs-lookup"><span data-stu-id="eafd5-158">Activities</span></span>|<span data-ttu-id="eafd5-159">클라이언트 및 서버의 ProcessAction 동작에서 추적을 내보냅니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-159">Traces are emitted in the ProcessAction activity on the client and server.</span></span>|  
|<span data-ttu-id="eafd5-160">추적</span><span class="sxs-lookup"><span data-stu-id="eafd5-160">Traces</span></span>|<span data-ttu-id="eafd5-161">-sendSecurityHeader (보낸 사람):</span><span class="sxs-lookup"><span data-stu-id="eafd5-161">-   sendSecurityHeader (sender):</span></span><br /><span data-ttu-id="eafd5-162">-메시지 서명</span><span class="sxs-lookup"><span data-stu-id="eafd5-162">-   Sign message</span></span><br /><span data-ttu-id="eafd5-163">-요청 데이터 암호화</span><span class="sxs-lookup"><span data-stu-id="eafd5-163">-   Encrypt request data</span></span><br /><span data-ttu-id="eafd5-164">-receiveSecurityHeader (수신자):</span><span class="sxs-lookup"><span data-stu-id="eafd5-164">-   receiveSecurityHeader (receiver):</span></span><br /><span data-ttu-id="eafd5-165">-서명 확인</span><span class="sxs-lookup"><span data-stu-id="eafd5-165">-   Verify signature</span></span><br /><span data-ttu-id="eafd5-166">-응답 데이터 암호 해독</span><span class="sxs-lookup"><span data-stu-id="eafd5-166">-   Decrypt response data</span></span><br /><span data-ttu-id="eafd5-167">-인증</span><span class="sxs-lookup"><span data-stu-id="eafd5-167">-   Authentication</span></span>|  
  
> [!NOTE]
> <span data-ttu-id="eafd5-168">순수 전송 모드에서는 추가 동작이 없는 전송에서만 메시지 암호화/해독이 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-168">In pure transport mode, message encryption/decryption happens only in transport with no additional activities.</span></span>  
  
## <a name="authorization-and-verification"></a><span data-ttu-id="eafd5-169">권한 부여 및 확인.</span><span class="sxs-lookup"><span data-stu-id="eafd5-169">Authorization and Verification</span></span>  

 <span data-ttu-id="eafd5-170">다음 표에서는 권한 부여에 대한 동작과 추적을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-170">The following table lists the activities and traces for authorization.</span></span>  
  
||<span data-ttu-id="eafd5-171">권한 부여 발생 시기</span><span class="sxs-lookup"><span data-stu-id="eafd5-171">Time when authorization happens</span></span>|<span data-ttu-id="eafd5-172">활동</span><span class="sxs-lookup"><span data-stu-id="eafd5-172">Activities</span></span>|<span data-ttu-id="eafd5-173">추적</span><span class="sxs-lookup"><span data-stu-id="eafd5-173">Traces</span></span>|  
|-|-------------------------------------|----------------|------------|  
|<span data-ttu-id="eafd5-174">로컬(기본값)</span><span class="sxs-lookup"><span data-stu-id="eafd5-174">Local (default)</span></span>|<span data-ttu-id="eafd5-175">서버에서 메시지가 해독된 후</span><span class="sxs-lookup"><span data-stu-id="eafd5-175">After the message is decrypted on the server</span></span>|<span data-ttu-id="eafd5-176">서버의 ProcessAction 동작에서 추적을 내보냅니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-176">Traces are emitted in the ProcessAction activity at the server.</span></span>|<span data-ttu-id="eafd5-177">사용자에게 권한이 부여되었습니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-177">User authorized.</span></span>|  
|<span data-ttu-id="eafd5-178">원격</span><span class="sxs-lookup"><span data-stu-id="eafd5-178">Remote</span></span>|<span data-ttu-id="eafd5-179">서버에서 메시지가 해독된 후</span><span class="sxs-lookup"><span data-stu-id="eafd5-179">After the message is decrypted on the server</span></span>|<span data-ttu-id="eafd5-180">ProcessAction 동작에 의해 호출된 새로운 동작에서 추적을 내보냅니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-180">Traces are emitted in a new activity invoked by the ProcessAction activity.</span></span>|<span data-ttu-id="eafd5-181">사용자에게 권한이 부여되었습니다.</span><span class="sxs-lookup"><span data-stu-id="eafd5-181">User authorized.</span></span>|
